<html>

<head>
    <meta charset="utf-8" />
<meta name="description" content="" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>
    spring | 卷毛
</title>
<link rel="shortcut icon" href="https://zoengzihaam.github.io/favicon.ico?v=1610626506137">
<!-- <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.7.2/css/all.css" integrity="sha384-fnmOCqbTlWIlj8LyTjo7mOUStjsKC4pOpQbqyi7RrhN7udi9RwhKkMHpvLbHG9Sr" crossorigin="anonymous"> -->
<link href="https://cdn.bootcss.com/font-awesome/4.7.0/css/font-awesome.min.css" rel="stylesheet">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.10.0/katex.min.css">
<link rel="stylesheet" href="https://zoengzihaam.github.io/styles/main.css">
<!-- js -->
<script src="https://cdn.bootcss.com/jquery/3.4.1/jquery.min.js"></script>
<script src="https://zoengzihaam.github.io/media/js/jquery.sticky-sidebar.min.js"></script>
<script src="https://cdn.bootcss.com/highlight.js/9.12.0/highlight.min.js"></script>
<script src="https://cdn.bootcss.com/moment.js/2.23.0/moment.min.js"></script>


</head>

<body>
    <div class="main">
        <div class="header">
    <div class="nav">
        <div class="logo">
            <a href="https://zoengzihaam.github.io">
                <img class="avatar" src="https://zoengzihaam.github.io/images/avatar.png?v=1610626506137" alt="">
            </a>
            <div class="site-title">
                <h1>
                    卷毛
                </h1>
            </div>
        </div>
        <span class="menu-btn fa fa-align-justify"></span>
        <div class="menu-container">
            <ul>
                
                    
                            <li>
                                <a href="/" class="menu">
                                    首页
                                </a>
                            </li>
                            
                                
                    
                            <li>
                                <a href="/archives" class="menu">
                                    归档
                                </a>
                            </li>
                            
                                
                    
                            <li>
                                <a href="/tags" class="menu">
                                    标签
                                </a>
                            </li>
                            
                                
                    
                            <li>
                                <a href="/post/about" class="menu">
                                    关于
                                </a>
                            </li>
                            
                                
            </ul>
        </div>
    </div>
</div>

<script>
    $(document).ready(function() {
        $(".menu-btn").click(function() {
            $(".menu-container").slideToggle();
        });
        $(window).resize(function() {

            if (window.matchMedia('(min-width: 960px)').matches) {
                $(".menu-container").css('display', 'block')
            } else {
                $(".menu-container").css('display', 'none')
            }

        });
    });
</script>

            <div id="main-content" class="post-container main-container">
                <div id="content" class="main-container-left">
                    
    <div class="i-card">
        <b>标签：#
        spring</b>
    </div>
    
        
            <article class="post i-card">
                <h2 class="post-title">
                    <a href="https://zoengzihaam.github.io/post/13/">
                        GateWay自定义全局GlobalFilter
                    </a>
                </h2>
                <div class="post-info">
                    <time class="post-time">2020-07-06</time>
                    
                        <a href="https://zoengzihaam.github.io/tag/hR2Q3InCJ/" class="post-tag i-tag
                            i-tag-info">
            #spring
        </a>
                        
                </div>
                <div class="post-article">
                    
                            <div class="post-content">
                                
                                        <div class="post-content-content">
                                            GateWay自定义全局GlobalFilter
1.实现两个接口


GlobalFilter
用于自定义过滤器，例如进行Token验证


Ordered
Spring提供了Ordered这个接口，来处理相同接口实现类的优先级问题。


import lombok.extern.slf4j.Slf4j;
import org.springframework.cloud.gateway.filter.GatewayFilterChain;
import org.springframework.cloud.gateway.filter.GlobalFilter;
import org.springframework.core.Ordered;
import org.springframework.http.HttpStatus;
import org.springframework.stereotype.Component;
import org.springframework.web.server.ServerWebExchange;
import reactor.core.publisher.Mono;

import java.util.Date;

@Component
@Slf4j
public class MyLogGateWayFilter implements GlobalFilter, Ordered {

    @Override
    public Mono&amp;lt;Void&amp;gt; filter(ServerWebExchange exchange, GatewayFilterChain chain) {

        //打印输出信息
        log.info(&amp;quot;************come in MyLogGateWayFilter&amp;quot; + new Date());

        //获取request中的参数
        String name = exchange.getRequest().getQueryParams().getFirst(&amp;quot;name&amp;quot;);
        //判断参数的信息
        if(name ==null){
            log.info(&amp;quot;************用户名为null，非法用户，/(ㄒoㄒ)/~~&amp;quot;);
            exchange.getResponse().setStatusCode(HttpStatus.NOT_ACCEPTABLE);
            return exchange.getResponse().setComplete();
        }

        return chain.filter(exchange);
    }

    @Override
    public int getOrder() {
        return 0;
    }
}

2. 使用CMD验证


遵循过滤器中的规则



不遵循过滤器中的规则



3.网页端测试


遵循过滤器中的规则



不遵循过滤器中的规则



结论：自定义Filter类似SpringMVC中的Filter，GlobalGilter 全局过滤器接口与 GatewayFilter 网关过滤器接口具有相同的方法定义。全局过滤器是一系列特殊的过滤器，会根据条件应用到所有路由中。网关过滤器是更细粒度的过滤器，作用于指定的路由中。

                                        </div>
                                        
                                            <a class="btn btn-text" href="https://zoengzihaam.github.io/post/13/">Read More ~</a>
                            </div>
                </div>
            </article>
            
            <article class="post i-card">
                <h2 class="post-title">
                    <a href="https://zoengzihaam.github.io/post/12/">
                        微服务中使用GateWay实现保护、增强和控制对于 API 服务的访问。
                    </a>
                </h2>
                <div class="post-info">
                    <time class="post-time">2020-07-06</time>
                    
                        <a href="https://zoengzihaam.github.io/tag/hR2Q3InCJ/" class="post-tag i-tag
                            i-tag-other_4">
            #spring
        </a>
                        
                </div>
                <div class="post-article">
                    
                            <div class="post-content">
                                
                                        <div class="post-content-content">
                                            微服务中使用GateWay实现保护、增强和控制对于 API 服务的访问。

网关的角色是作为一个 API 架构，用来保护、增强和控制对于 API 服务的访问。
API 网关是一个处于应用程序或服务（提供 REST API 接口服务）之前的系统，用来管理授权、访问控制和流量限制等，这样 REST API 接口服务就被 API 网关保护起来，对所有的调用者透明。因此，隐藏在 API 网关后面的业务系统就可以专注于创建和管理服务，而不用去处理这些策略性的基础设施。

简单使用
三个概念

注：上图引用CSDN博主AlgoRain，这里致谢一下大佬详细的讲解。
springcloud中使用
1.新建Module
添加一个新的Module，cloud-gateway-gateway9527（名称按照自己喜好）
2.添加POM依赖
&amp;lt;dependencies&amp;gt;
        &amp;lt;!--gateway--&amp;gt;
        &amp;lt;dependency&amp;gt;
            &amp;lt;groupId&amp;gt;org.springframework.cloud&amp;lt;/groupId&amp;gt;
            &amp;lt;artifactId&amp;gt;spring-cloud-starter-gateway&amp;lt;/artifactId&amp;gt;
        &amp;lt;/dependency&amp;gt;
        &amp;lt;!--Eureka client--&amp;gt;
        &amp;lt;dependency&amp;gt;
            &amp;lt;groupId&amp;gt;org.springframework.cloud&amp;lt;/groupId&amp;gt;
            &amp;lt;artifactId&amp;gt;spring-cloud-starter-netflix-eureka-client&amp;lt;/artifactId&amp;gt;
        &amp;lt;/dependency&amp;gt;
        &amp;lt;!--导入自己定义的api通用包--&amp;gt;
        &amp;lt;dependency&amp;gt;
            &amp;lt;groupId&amp;gt;com.ziznah.springcloud&amp;lt;/groupId&amp;gt;
            &amp;lt;artifactId&amp;gt;cloud-api-commons&amp;lt;/artifactId&amp;gt;
            &amp;lt;version&amp;gt;${project.version}&amp;lt;/version&amp;gt;
        &amp;lt;/dependency&amp;gt;
        &amp;lt;!--一般基础配置类--&amp;gt;
        &amp;lt;dependency&amp;gt;
            &amp;lt;groupId&amp;gt;org.springframework.boot&amp;lt;/groupId&amp;gt;
            &amp;lt;artifactId&amp;gt;spring-boot-devtools&amp;lt;/artifactId&amp;gt;
            &amp;lt;scope&amp;gt;runtime&amp;lt;/scope&amp;gt;
            &amp;lt;optional&amp;gt;true&amp;lt;/optional&amp;gt;
        &amp;lt;/dependency&amp;gt;
        &amp;lt;dependency&amp;gt;
            &amp;lt;groupId&amp;gt;org.projectlombok&amp;lt;/groupId&amp;gt;
            &amp;lt;artifactId&amp;gt;lombok&amp;lt;/artifactId&amp;gt;
            &amp;lt;optional&amp;gt;true&amp;lt;/optional&amp;gt;
        &amp;lt;/dependency&amp;gt;
        &amp;lt;dependency&amp;gt;
            &amp;lt;groupId&amp;gt;org.springframework.boot&amp;lt;/groupId&amp;gt;
            &amp;lt;artifactId&amp;gt;spring-boot-starter-test&amp;lt;/artifactId&amp;gt;
            &amp;lt;scope&amp;gt;test&amp;lt;/scope&amp;gt;
        &amp;lt;/dependency&amp;gt;
&amp;lt;/dependencies&amp;gt;

3.添加YML文件
#配置端口
server:
  port: 9527

spring:
  application:
    name: cloud-gateway
  cloud:
    gateway:
      routes:
        - id: payment_routh #payment_route    #路由的ID，没有固定规则但要求唯一，建议配合服务名
          uri: http://localhost:8001          #匹配后提供服务的路由地址
          predicates:
            - Path=/payment/get/**         # 断言，路径相匹配的进行路由

        - id: payment_routh2 #payment_route    #路由的ID，没有固定规则但要求唯一，建议配合服务名
          uri: http://localhost:8001          #匹配后提供服务的路由地址
          predicates:
            - Path=/payment/lb/**         # 断言，路径相匹配的进行路由
#注册进服务中心，这里使用的是eureka
eureka:
  instance:
    hostname: cloud-gateway-service
  client: #服务提供者provider注册进eureka服务列表内
    service-url:
      register-with-eureka: true
      fetch-registry: true
      defaultZone: http://localhost:7001/eureka/


4.主启动类
import org.springframework.boot.SpringApplication;
import org.springframework.boot.autoconfigure.SpringBootApplication;
import org.springframework.cloud.client.discovery.EnableDiscoveryClient;
import org.springframework.cloud.netflix.eureka.EnableEurekaClient;

@SpringBootApplication
@EnableEurekaClient
@EnableDiscoveryClient
public class GateWayMain9527 {
    public static void main(String[] args) {
        SpringApplication.run(GateWayMain9527.class,args);
    }
}

使用配置类来简单使用GateWay

将http://localhost:9527/guonei转发到百度的新闻网中的国内信息

import org.springframework.cloud.gateway.route.RouteLocator;
import org.springframework.cloud.gateway.route.builder.RouteLocatorBuilder;
import org.springframework.context.annotation.Bean;
import org.springframework.context.annotation.Configuration;

@Configuration
public class GateWayConfig {

    /**
     * 配置一个id为route-name的路由规则，
     * 当访问地址http://localhost:9527/guonei时会自动转发到地址：http://news.baidu.com/guonei
     * @param routeLocatorBuilder
     * @return
     */
    @Bean
    public RouteLocator customRouteLocator(RouteLocatorBuilder routeLocatorBuilder){
        //获取网关的routes
        RouteLocatorBuilder.Builder routes = routeLocatorBuilder.routes();
        //设置网关的内容
        routes.route(&amp;quot;path_route_ziznah&amp;quot;,r -&amp;gt; r.path(&amp;quot;/guonei&amp;quot;).uri(&amp;quot;http://news.baidu.com/guonei&amp;quot;)).build();

        //返回内容
        return routes.build();
    }
}

实现动态路由

多个服务提供者进行提供服务，使用动态路由来到达负载均衡

1.YML
server:
  port: 9527

spring:
  application:
    name: cloud-gateway
  cloud:
    gateway:
     #开启动态创建路由的功能
      discovery:
        locator:
          enabled: true   #开启从注册中心动态创建路由的功能，利用微服务名进行路由
      routes:
        - id: payment_routh #payment_route    #路由的ID，没有固定规则但要求唯一，建议配合服务名
#          uri: http://localhost:8001          #匹配后提供服务的路由地址
          uri: lb://cloud-payment-service   #匹配后提供服务的路由地址
          predicates:
            - Path=/payment/get/**         # 断言，路径相匹配的进行路由

        - id: payment_routh2 #payment_route    #路由的ID，没有固定规则但要求唯一，建议配合服务名
#          uri: http://localhost:8001          #匹配后提供服务的路由地址
          uri: lb://cloud-payment-service   #匹配后提供服务的路由地址
          predicates:
            - Path=/payment/lb/**         # 断言，路径相匹配的进行路由

eureka:
  instance:
    hostname: cloud-gateway-service
  client: #服务提供者provider注册进eureka服务列表内
    service-url:
      register-with-eureka: true
      fetch-registry: true
      defaultZone: http://localhost:7001/eureka/

注：需要注意的是uri的协议lb，表示启用Gateway的负载均衡功能，lb://serverName是spring cloud  gatway在微服务中自动为我们创建的负载均衡uri。
predicates断言不同类型
1.After

YML文件

# 断言，路径相匹配的进行路由
predicates:		
	- After=2020-07-06T16:43:08.146+08:00[Asia/Shanghai]

上述的时间地址可使用Java中time的api来获取：
import java.time.ZoneId;
import java.time.ZonedDateTime;

public class T2 {
    public static void main(String[] args) {
        //获取默认时区
        ZonedDateTime zdt = ZonedDateTime.now();
        System.out.println(zdt);
        //通过指定时区获取当前时间
        ZonedDateTime now = ZonedDateTime.now(ZoneId.of(&amp;quot;America/New_York&amp;quot;));
        System.out.println(now);
    }
}


2.Before
方法同After
3.Between
方法同After
4.Cookie

YML文件

# 断言，路径相匹配的进行路由
predicates:		
	- Cookie=ceshi,admin	

Windows中CMD窗口使用curl命令进行http请求

不带Cookie进行访问测试。



带Cookie进行访问测试。


5.Header

YML文件

# 断言，路径相匹配的进行路由
predicates:		
	- Header=X-Request-Id, \d+		#请求头要有X-Request-Id属性，并且值为正数的正则表达式。

使用CMD的curl命令测试

带Header




不带Header



带错误的Header信息



6.Host

YML

# 断言，路径相匹配的进行路由
predicates:		
	- Host=**.ceshi.com

使用CMD的curl命令测试


带Host测试



不带Host测试



带错误Host测试



7.Method

YML

# 断言，路径相匹配的进行路由
predicates:		
	- Method=GET

8.Path
9.Query
10.Weight

                                        </div>
                                        
                                            <a class="btn btn-text" href="https://zoengzihaam.github.io/post/12/">Read More ~</a>
                            </div>
                </div>
            </article>
            
            <article class="post i-card">
                <h2 class="post-title">
                    <a href="https://zoengzihaam.github.io/post/11/">
                        参考RoundRobinRule代码模拟负载均衡
                    </a>
                </h2>
                <div class="post-info">
                    <time class="post-time">2020-06-25</time>
                    
                        <a href="https://zoengzihaam.github.io/tag/hR2Q3InCJ/" class="post-tag i-tag
                            i-tag-info">
            #spring
        </a>
                        
                </div>
                <div class="post-article">
                    
                            <div class="post-content">
                                
                                        <div class="post-content-content">
                                            参考RoundRobinRule代码模拟负载均衡
1.定义一个LoadBalancer接口

获取服务器集群上能够提供服务的机器数量

public interface Loadbalancer {
    /**
     * 获取服务器集群上能够提供服务的机器数量
     * @param serviceInstances
     * @return
     */
    ServiceInstance instances(List&amp;lt;ServiceInstance&amp;gt; serviceInstances);
}

2.实现LoadBalancer接口中的方法

利用自旋锁，创建获取当前服务调用是第几次访问的方法
实现接口中获取提供服务机器数量的方法，模拟负载均衡算法来达到负载调用服务。

/**
 * ClassName: MyLB
 * Description: 参考RoundRobinRule代码模拟负载均衡
 * Author: SUGAR
 * Date: 2020/6/25 16:09
 * Version: 1.0
 **/
@Component
public class MyLB implements Loadbalancer{

    private AtomicInteger atomicInteger = new AtomicInteger(0);

    /**
     * 获取当前服务调用是第几次访问
     * @return
     */
    public final int getAndIncrement(){
        int current;
        int next;

        do {
            current = this.atomicInteger.get();
            next = current &amp;gt;= 2147483647 ? 0 : current + 1;
        }while (!this.atomicInteger.compareAndSet(current,next));
        System.out.println(&amp;quot;*****访问第&amp;quot; + next + &amp;quot;次！*****&amp;quot;);
        return next;
    }

    /**
     * 根据第几次访问，模拟负载均衡算法来达到负载调用服务
     * 负载均衡算法：rest接口第几次请求数 % 服务器集群总数量 = 实际调用服务器位置下标
     * 每次服务启动后rest接口计数从1开始
     * @param serviceInstances
     * @return
     */
    @Override
    public ServiceInstance instances(List&amp;lt;ServiceInstance&amp;gt; serviceInstances) {

        int index = getAndIncrement() % serviceInstances.size();

        return serviceInstances.get(index);
    }
}

3.取消LoadBalanced注解

取消ApplicationContextConfig中RestTemplate的get方法的LoadBalanced注解，使用自己模拟的负载均衡。

@Configuration
public class ApplicationContextConfig {

    @Bean
//    @LoadBalanced 使用自己模拟的负载均衡的方法
    public RestTemplate getRestTemplate(){
        return new RestTemplate();
    }
}

4.添加服务提供商提供的controller方法

添加一个获取当前服务提供者端口的方法，用来负载均衡。

@GetMapping(value = &amp;quot;/payment/lb&amp;quot;)
public String getPaymentLB() {
    return serverPort;
}

注：这里的方法添加到提供商的controller中。
5.调用者添加controller方法

调用者controller添加调用服务提供商的方法，测试负载均衡

@GetMapping(value = &amp;quot;/consumer/payment/lb&amp;quot;)
public String getPayementLB(){
    List&amp;lt;ServiceInstance&amp;gt; instances = discoveryClient.getInstances(&amp;quot;CLOUD-PAYMENT-SERVICE&amp;quot;);
    //判断服务是否为有效服务
    if(instances == null || instances.size() &amp;lt;= 0){
        return null;
    }

    ServiceInstance serviceInstance = loadbalancer.instances(instances);
    URI uri = serviceInstance.getUri();

    return restTemplate.getForObject(uri + &amp;quot;/payment/lb&amp;quot;,String.class);
}

6.测试

启动对应的服务



查看是否启动成功（模拟提供者集群以及服务器集群）



模拟调用者访问接口




​	根据以上调用，后台也打印出相应的调用信息。

                                        </div>
                                        
                                            <a class="btn btn-text" href="https://zoengzihaam.github.io/post/11/">Read More ~</a>
                            </div>
                </div>
            </article>
            
            <article class="post i-card">
                <h2 class="post-title">
                    <a href="https://zoengzihaam.github.io/post/3/">
                        SSM框架IDEA的配置
                    </a>
                </h2>
                <div class="post-info">
                    <time class="post-time">2020-06-02</time>
                    
                        <a href="https://zoengzihaam.github.io/tag/hR2Q3InCJ/" class="post-tag i-tag
                            i-tag-other_2">
            #spring
        </a>
                        
                </div>
                <div class="post-article">
                    
                            <div class="post-content">
                                
                                        <div class="post-content-content">
                                            
用于IDEA搭建SSM框架的配置环境

1. 设置IDEA的maven项目的架构设置
设置Project Structure，将所缺的Sources，Tests，Resources配置完成，以及web.xml的版本更改为3.1。
2. 创建ssm框架的package，以及对应的包
创建domain，mapper，service，web
domain：存放实体类
mapper：存放数据库操作的类
service：存放服务层
web：存放springMVC的servlet控制器，controller文件
3. 在resources文件夹中创建spring以及mybatis文件夹，用于存放对应的文件
resources：

	spring文件夹：用于存放spring所需的配置文件

		applicationContext.xml：用于配置spring的配置信息

		springmvc-servlet.xml：用于配置springMVC的配置

	mybatis文件夹：用于存放mybatis所需的配置文件

		mapper文件夹：用于存放mybatis的sql配置

			mybatis-config.xml：用于配置mybatis的全局配置

	database.properties：用于配置数据库的配置信息

	log4j.xml：用于配置日志的配置信息

4. webapp下的配置
在webapp下搭建缺少的一些环境以及内容
static文件夹：用于存放web工程需要的资源文件

css文件夹：用于存放页面的css文件

js文件夹：用于存放页面的js文件

img文件夹：用于存放页面的img文件

lib文件夹：用于存放页面的lib文件

WEB-INF文件夹下创建views文件夹：存放页面(文件安全)
5. 配置SSM框架所缺少的环境配置
配置pom.xml文件中缺少的ssm框架依赖的jar包
&amp;lt;dependencies&amp;gt;
    &amp;lt;dependency&amp;gt;
      &amp;lt;groupId&amp;gt;junit&amp;lt;/groupId&amp;gt;
      &amp;lt;artifactId&amp;gt;junit&amp;lt;/artifactId&amp;gt;
      &amp;lt;version&amp;gt;4.12&amp;lt;/version&amp;gt;
      &amp;lt;scope&amp;gt;test&amp;lt;/scope&amp;gt;
    &amp;lt;/dependency&amp;gt;

    &amp;lt;!--配置JavaEE的开发jar包--&amp;gt;
    &amp;lt;dependency&amp;gt;
      &amp;lt;groupId&amp;gt;javax&amp;lt;/groupId&amp;gt;
      &amp;lt;artifactId&amp;gt;javaee-api&amp;lt;/artifactId&amp;gt;
      &amp;lt;version&amp;gt;8.0&amp;lt;/version&amp;gt;
      &amp;lt;scope&amp;gt;provided&amp;lt;/scope&amp;gt;
    &amp;lt;/dependency&amp;gt;

    &amp;lt;!--配置mysql所需的jar包--&amp;gt;
    &amp;lt;dependency&amp;gt;
      &amp;lt;groupId&amp;gt;mysql&amp;lt;/groupId&amp;gt;
      &amp;lt;artifactId&amp;gt;mysql-connector-java&amp;lt;/artifactId&amp;gt;
      &amp;lt;version&amp;gt;5.1.48&amp;lt;/version&amp;gt;
    &amp;lt;/dependency&amp;gt;

    &amp;lt;!--配置阿里巴巴的德鲁伊数据源--&amp;gt;
    &amp;lt;dependency&amp;gt;
      &amp;lt;groupId&amp;gt;com.alibaba&amp;lt;/groupId&amp;gt;
      &amp;lt;artifactId&amp;gt;druid&amp;lt;/artifactId&amp;gt;
      &amp;lt;version&amp;gt;1.1.21&amp;lt;/version&amp;gt;
    &amp;lt;/dependency&amp;gt;

    &amp;lt;!--配置JSTL--&amp;gt;
    &amp;lt;dependency&amp;gt;
      &amp;lt;groupId&amp;gt;jstl&amp;lt;/groupId&amp;gt;
      &amp;lt;artifactId&amp;gt;jstl&amp;lt;/artifactId&amp;gt;
      &amp;lt;version&amp;gt;1.2&amp;lt;/version&amp;gt;
    &amp;lt;/dependency&amp;gt;

    &amp;lt;!--配置mybatis--&amp;gt;
    &amp;lt;dependency&amp;gt;
      &amp;lt;groupId&amp;gt;org.mybatis&amp;lt;/groupId&amp;gt;
      &amp;lt;artifactId&amp;gt;mybatis&amp;lt;/artifactId&amp;gt;
      &amp;lt;version&amp;gt;3.4.6&amp;lt;/version&amp;gt;
    &amp;lt;/dependency&amp;gt;

    &amp;lt;!--配置spring--&amp;gt;
    &amp;lt;dependency&amp;gt;
      &amp;lt;groupId&amp;gt;org.springframework&amp;lt;/groupId&amp;gt;
      &amp;lt;artifactId&amp;gt;spring-context&amp;lt;/artifactId&amp;gt;
      &amp;lt;version&amp;gt;5.2.1.RELEASE&amp;lt;/version&amp;gt;
    &amp;lt;/dependency&amp;gt;

    &amp;lt;!--配置springMVC--&amp;gt;
    &amp;lt;dependency&amp;gt;
      &amp;lt;groupId&amp;gt;org.springframework&amp;lt;/groupId&amp;gt;
      &amp;lt;artifactId&amp;gt;spring-webmvc&amp;lt;/artifactId&amp;gt;
      &amp;lt;version&amp;gt;5.2.1.RELEASE&amp;lt;/version&amp;gt;
    &amp;lt;/dependency&amp;gt;

    &amp;lt;!--配置spring对数据库支持的jar包--&amp;gt;
    &amp;lt;dependency&amp;gt;
      &amp;lt;groupId&amp;gt;org.springframework&amp;lt;/groupId&amp;gt;
      &amp;lt;artifactId&amp;gt;spring-jdbc&amp;lt;/artifactId&amp;gt;
      &amp;lt;version&amp;gt;5.2.1.RELEASE&amp;lt;/version&amp;gt;
    &amp;lt;/dependency&amp;gt;

    &amp;lt;!--配置spring整合mybatis需要的jar包--&amp;gt;
    &amp;lt;dependency&amp;gt;
      &amp;lt;groupId&amp;gt;org.mybatis&amp;lt;/groupId&amp;gt;
      &amp;lt;artifactId&amp;gt;mybatis-spring&amp;lt;/artifactId&amp;gt;
      &amp;lt;version&amp;gt;1.3.2&amp;lt;/version&amp;gt;
    &amp;lt;/dependency&amp;gt;

    &amp;lt;!--配置hibernate--&amp;gt;
    &amp;lt;dependency&amp;gt;
      &amp;lt;groupId&amp;gt;org.hibernate.validator&amp;lt;/groupId&amp;gt;
      &amp;lt;artifactId&amp;gt;hibernate-validator&amp;lt;/artifactId&amp;gt;
      &amp;lt;version&amp;gt;6.1.0.Final&amp;lt;/version&amp;gt;
    &amp;lt;/dependency&amp;gt;

    &amp;lt;!--配置aop注解--&amp;gt;
    &amp;lt;dependency&amp;gt;
      &amp;lt;groupId&amp;gt;org.aspectj&amp;lt;/groupId&amp;gt;
      &amp;lt;artifactId&amp;gt;aspectjweaver&amp;lt;/artifactId&amp;gt;
      &amp;lt;version&amp;gt;1.9.5&amp;lt;/version&amp;gt;
    &amp;lt;/dependency&amp;gt;

    &amp;lt;!--配置日志--&amp;gt;
    &amp;lt;dependency&amp;gt;
      &amp;lt;groupId&amp;gt;org.apache.logging.log4j&amp;lt;/groupId&amp;gt;
      &amp;lt;artifactId&amp;gt;log4j-core&amp;lt;/artifactId&amp;gt;
      &amp;lt;version&amp;gt;2.11.2&amp;lt;/version&amp;gt;
    &amp;lt;/dependency&amp;gt;

&amp;lt;/dependencies&amp;gt;

1.配置mybatis-config.xml的内容
&amp;lt;?xml version=&#39;1.0&#39; encoding=&#39;UTF-8&#39;?&amp;gt;
&amp;lt;!DOCTYPE configuration PUBLIC &amp;quot;-//mybatis.org//DTD Config 3.0//EN&amp;quot; &amp;quot;http://mybatis.org/dtd/mybatis-3-config.dtd&amp;quot; &amp;gt;
&amp;lt;configuration&amp;gt;

    &amp;lt;!--全局配置--&amp;gt;
    &amp;lt;settings&amp;gt;
        &amp;lt;!--启用缓存--&amp;gt;
        &amp;lt;setting name=&amp;quot;cacheEnabled&amp;quot; value=&amp;quot;true&amp;quot;/&amp;gt;
        &amp;lt;!--启用日志--&amp;gt;
        &amp;lt;setting name=&amp;quot;logImpl&amp;quot; value=&amp;quot;LOG4J2&amp;quot;/&amp;gt;
        &amp;lt;!--启用主键生成策略--&amp;gt;
        &amp;lt;setting name=&amp;quot;useGeneratedKeys&amp;quot; value=&amp;quot;true&amp;quot;/&amp;gt;
        &amp;lt;!--启用下划线命名自动转驼峰命名--&amp;gt;
        &amp;lt;setting name=&amp;quot;mapUnderscoreToCamelCase&amp;quot; value=&amp;quot;true&amp;quot;/&amp;gt;
    &amp;lt;/settings&amp;gt;

&amp;lt;/configuration&amp;gt;

2.配置database.properties的数据库配置文件
jdbc.driver=com.mysql.jdbc.Driver
jdbc.url=jdbc:msql://localhost:3306/bbs
jdbc.username=root
jdbc.password=

3. 配置log4j.xml的日志配置
&amp;lt;?xml version=&amp;quot;1.0&amp;quot; encoding=&amp;quot;UTF-8&amp;quot;?&amp;gt;
&amp;lt;Configuration status=&amp;quot;WARN&amp;quot;&amp;gt;
	&amp;lt;!--日志追加器：日志通过什么方式输出--&amp;gt;
	&amp;lt;Appenders&amp;gt;
		&amp;lt;Console name=&amp;quot;Console&amp;quot; target=&amp;quot;SYSTEM_OUT&amp;quot;&amp;gt;
			&amp;lt;PatternLayout pattern=&amp;quot;%d{HH:mm:ss.SSS} [%t] %-5level %logger{36} - %msg%n&amp;quot; /&amp;gt;
		&amp;lt;/Console&amp;gt;
	&amp;lt;/Appenders&amp;gt;
	
	&amp;lt;Loggers&amp;gt;
		&amp;lt;Root level=&amp;quot;debug&amp;quot;&amp;gt;
			&amp;lt;AppenderRef ref=&amp;quot;Console&amp;quot; /&amp;gt;
		&amp;lt;/Root&amp;gt;
		&amp;lt;!-- &amp;lt;logger name=&amp;quot;org.springframework.web&amp;quot; level=&amp;quot;error&amp;quot; &amp;gt;&amp;lt;/logger&amp;gt; --&amp;gt;
	&amp;lt;/Loggers&amp;gt;
&amp;lt;/Configuration&amp;gt;

4.配置applicationContext.xml的spring配置信息
&amp;lt;?xml version=&amp;quot;1.0&amp;quot; encoding=&amp;quot;UTF-8&amp;quot;?&amp;gt;
&amp;lt;beans xmlns=&amp;quot;http://www.springframework.org/schema/beans&amp;quot;
       xmlns:xsi=&amp;quot;http://www.w3.org/2001/XMLSchema-instance&amp;quot;
       xmlns:context=&amp;quot;http://www.springframework.org/schema/context&amp;quot;
       xmlns:aop=&amp;quot;http://www.springframework.org/schema/aop&amp;quot;
       xmlns:mvc=&amp;quot;http://www.springframework.org/schema/mvc&amp;quot; xmlns:tx=&amp;quot;http://www.alibaba.com/schema/stat&amp;quot;
       xsi:schemaLocation=&amp;quot;http://www.springframework.org/schema/beans
       http://www.springframework.org/schema/beans/spring-beans.xsd
       http://www.springframework.org/schema/context
       http://www.springframework.org/schema/context/spring-context.xsd
       http://www.springframework.org/schema/aop
       http://www.springframework.org/schema/aop/spring-aop.xsd
       http://www.springframework.org/schema/mvc
       http://www.springframework.org/schema/mvc/spring-mvc.xsd http://www.alibaba.com/schema/stat http://www.alibaba.com/schema/stat.xsd&amp;quot;&amp;gt;
         &amp;lt;!--配置属性文件的加载--&amp;gt;
	    &amp;lt;context:property-placeholder location=&amp;quot;classpath:database.properties&amp;quot;&amp;gt;&amp;lt;/context:property-placeholder&amp;gt;
	
	    &amp;lt;!--配置数据源--&amp;gt;
	    &amp;lt;bean id=&amp;quot;dataSource&amp;quot; class=&amp;quot;com.alibaba.druid.pool.DruidDataSource&amp;quot;&amp;gt;
	        &amp;lt;property name=&amp;quot;driverClassName&amp;quot; value=&amp;quot;${jdbc.driver}&amp;quot;/&amp;gt;
	        &amp;lt;property name=&amp;quot;url&amp;quot; value=&amp;quot;${jdbc.url}&amp;quot;/&amp;gt;
	        &amp;lt;property name=&amp;quot;username&amp;quot; value=&amp;quot;${jdbc.username}&amp;quot;/&amp;gt;
	        &amp;lt;property name=&amp;quot;password&amp;quot; value=&amp;quot;${jdbc.password}&amp;quot;/&amp;gt;
	    &amp;lt;/bean&amp;gt;
	&amp;lt;!--配置sqlsessionFactory--&amp;gt;
    &amp;lt;bean id=&amp;quot;sqlSessionFactory&amp;quot; class=&amp;quot;org.mybatis.spring.SqlSessionFactoryBean&amp;quot;&amp;gt;
        &amp;lt;property name=&amp;quot;dataSource&amp;quot; ref=&amp;quot;dataSource&amp;quot;/&amp;gt;
        &amp;lt;property name=&amp;quot;configLocation&amp;quot; value=&amp;quot;classpath:mybatis/mybatis-config.xml&amp;quot;/&amp;gt;
        &amp;lt;property name=&amp;quot;mapperLocations&amp;quot; value=&amp;quot;classpath:mybatis/mapper/*.xml&amp;quot;/&amp;gt;
    &amp;lt;/bean&amp;gt;

    &amp;lt;!--配置mapper扫描注解--&amp;gt;
    &amp;lt;bean id=&amp;quot;scannerConfigurer&amp;quot; class=&amp;quot;org.mybatis.spring.mapper.MapperScannerConfigurer&amp;quot;&amp;gt;
        &amp;lt;property name=&amp;quot;sqlSessionFactoryBeanName&amp;quot; value=&amp;quot;sqlSessionFactory&amp;quot;/&amp;gt;
        &amp;lt;property name=&amp;quot;basePackage&amp;quot; value=&amp;quot;com.sugarzhang.spring.mapper&amp;quot;/&amp;gt;
    &amp;lt;/bean&amp;gt;

    &amp;lt;!--配置事务管理器--&amp;gt;
    &amp;lt;bean id=&amp;quot;transactionManager&amp;quot; class=&amp;quot;org.springframework.jdbc.datasource.DataSourceTransactionManager&amp;quot;&amp;gt;
        &amp;lt;property name=&amp;quot;dataSource&amp;quot; ref=&amp;quot;dataSource&amp;quot;/&amp;gt;
    &amp;lt;/bean&amp;gt;

    &amp;lt;!--配置注解扫描的包--&amp;gt;
    &amp;lt;context:component-scan base-package=&amp;quot;com.sugarzhang.spring&amp;quot; use-default-filters=&amp;quot;true&amp;quot;&amp;gt;
        &amp;lt;!--排除Controller--&amp;gt;
        &amp;lt;context:exclude-filter type=&amp;quot;annotation&amp;quot; expression=&amp;quot;org.springframework.stereotype.Controller&amp;quot;/&amp;gt;
    &amp;lt;/context:component-scan&amp;gt;

    &amp;lt;!--配置事务注解--&amp;gt;
    &amp;lt;tx:annotation-driven/&amp;gt;

    &amp;lt;!--配置aop--&amp;gt;
    &amp;lt;aop:aspectj-autoproxy/&amp;gt;

&amp;lt;/beans&amp;gt;    

5.配置springmvc-servlet.xml的springMVC的配置信息
&amp;lt;?xml version=&amp;quot;1.0&amp;quot; encoding=&amp;quot;UTF-8&amp;quot;?&amp;gt;
&amp;lt;beans xmlns=&amp;quot;http://www.springframework.org/schema/beans&amp;quot;
       xmlns:xsi=&amp;quot;http://www.w3.org/2001/XMLSchema-instance&amp;quot;
       xmlns:mvc=&amp;quot;http://www.springframework.org/schema/mvc&amp;quot;
       xmlns:context=&amp;quot;http://www.springframework.org/schema/context&amp;quot;
       xsi:schemaLocation=&amp;quot;http://www.springframework.org/schema/beans
       http://www.springframework.org/schema/beans/spring-beans.xsd
       http://www.springframework.org/schema/mvc
       https://www.springframework.org/schema/mvc/spring-mvc.xsd
       http://www.springframework.org/schema/context
       https://www.springframework.org/schema/context/spring-context.xsd&amp;quot;&amp;gt;

    &amp;lt;!--配置视图解析器--&amp;gt;
    &amp;lt;bean class=&amp;quot;org.springframework.web.servlet.view.InternalResourceViewResolver&amp;quot;&amp;gt;
        &amp;lt;property name=&amp;quot;prefix&amp;quot; value=&amp;quot;/WEB-INF/views/&amp;quot;/&amp;gt;
        &amp;lt;property name=&amp;quot;suffix&amp;quot; value=&amp;quot;.jsp&amp;quot;/&amp;gt;
    &amp;lt;/bean&amp;gt;

    &amp;lt;!--配置资源过滤器--&amp;gt;
    &amp;lt;mvc:default-servlet-handler/&amp;gt;

    &amp;lt;!--配置mvc扫描的包--&amp;gt;
    &amp;lt;context:component-scan base-package=&amp;quot;com.sugarzhang.spring&amp;quot; use-default-filters=&amp;quot;false&amp;quot;&amp;gt;
        &amp;lt;!--只扫描controller--&amp;gt;
        &amp;lt;context:include-filter type=&amp;quot;annotation&amp;quot; expression=&amp;quot;org.springframework.stereotype.Controller&amp;quot;/&amp;gt;
    &amp;lt;/context:component-scan&amp;gt;

	&amp;lt;!--配置MVC的注解扫描驱动--&amp;gt;
    &amp;lt;mvc:annotation-driven/&amp;gt;

&amp;lt;/beans&amp;gt;

6.配置web.xml的配置信息
&amp;lt;?xml version=&amp;quot;1.0&amp;quot; encoding=&amp;quot;UTF-8&amp;quot;?&amp;gt;
&amp;lt;web-app xmlns=&amp;quot;http://xmlns.jcp.org/xml/ns/javaee&amp;quot;
         xmlns:xsi=&amp;quot;http://www.w3.org/2001/XMLSchema-instance&amp;quot;
         xsi:schemaLocation=&amp;quot;http://xmlns.jcp.org/xml/ns/javaee http://xmlns.jcp.org/xml/ns/javaee/web-app_3_1.xsd&amp;quot;
         version=&amp;quot;3.1&amp;quot;&amp;gt;
    
    &amp;lt;!--配置springIOC--&amp;gt;
    &amp;lt;context-param&amp;gt;
        &amp;lt;param-name&amp;gt;contextConfigLocation&amp;lt;/param-name&amp;gt;
        &amp;lt;param-value&amp;gt;classpath:spring/applicationContext.xml&amp;lt;/param-value&amp;gt;
    &amp;lt;/context-param&amp;gt;
    &amp;lt;listener&amp;gt;
        &amp;lt;listener-class&amp;gt;org.springframework.web.context.ContextLoaderListener&amp;lt;/listener-class&amp;gt;
    &amp;lt;/listener&amp;gt;
    
    &amp;lt;!--配置springMVC控制器--&amp;gt;
    &amp;lt;servlet&amp;gt;
        &amp;lt;servlet-name&amp;gt;SpringMVC&amp;lt;/servlet-name&amp;gt;
		&amp;lt;servlet-class&amp;gt;org.springframework.web.servlet.DispatcherServlet&amp;lt;/servlet-class&amp;gt;
        &amp;lt;init-param&amp;gt;
            &amp;lt;param-name&amp;gt;contextConfigLocation&amp;lt;/param-name&amp;gt;
            &amp;lt;param-value&amp;gt;classpath:spring/springmvc-servlet.xml&amp;lt;/param-value&amp;gt;
        &amp;lt;/init-param&amp;gt;
        &amp;lt;load-on-startup&amp;gt;1&amp;lt;/load-on-startup&amp;gt;
    &amp;lt;/servlet&amp;gt;
    &amp;lt;servlet-mapping&amp;gt;
        &amp;lt;servlet-name&amp;gt;SpringMVC&amp;lt;/servlet-name&amp;gt;
        &amp;lt;url-pattern&amp;gt;/&amp;lt;/url-pattern&amp;gt;
    &amp;lt;/servlet-mapping&amp;gt;

    &amp;lt;!--配置springMVC编码--&amp;gt;
    &amp;lt;filter&amp;gt;
        &amp;lt;filter-name&amp;gt;encodingFilter&amp;lt;/filter-name&amp;gt;
        &amp;lt;filter-class&amp;gt;org.springframework.web.filter.CharacterEncodingFilter&amp;lt;/filter-class&amp;gt;
        &amp;lt;init-param&amp;gt;
            &amp;lt;param-name&amp;gt;encoding&amp;lt;/param-name&amp;gt;
            &amp;lt;param-value&amp;gt;UTF-8&amp;lt;/param-value&amp;gt;
        &amp;lt;/init-param&amp;gt;
        &amp;lt;init-param&amp;gt;
            &amp;lt;param-name&amp;gt;forceEncoding&amp;lt;/param-name&amp;gt;
            &amp;lt;param-value&amp;gt;true&amp;lt;/param-value&amp;gt;
        &amp;lt;/init-param&amp;gt;
    &amp;lt;/filter&amp;gt;
    &amp;lt;filter-mapping&amp;gt;
        &amp;lt;filter-name&amp;gt;encodingFilter&amp;lt;/filter-name&amp;gt;
        &amp;lt;url-pattern&amp;gt;/*&amp;lt;/url-pattern&amp;gt;
    &amp;lt;/filter-mapping&amp;gt;
    
&amp;lt;/web-app&amp;gt;


                                        </div>
                                        
                                            <a class="btn btn-text" href="https://zoengzihaam.github.io/post/3/">Read More ~</a>
                            </div>
                </div>
            </article>
            
                <!-- 翻页 -->
                
                </div>
                <!--  -->
                <div class="main-container-middle"></div>
                <!--  -->
                <div id="sidebar" class="main-container-right">

                    <!-- 个人信息 -->
                    
    <div class="id_card i-card">
        <div class="id_card-avatar" style="background-image: url(https://zoengzihaam.github.io/images/avatar.png?v=1610626506137)">
        </div>
        <h1 class="id_card-title">
            卷毛
        </h1>
        <h2 class="id_card-description">
            没有撤退可言。
        </h2>
        <!--  -->
        <div class="id_card-sns">
            <!-- github -->
            
                    <!-- twitter -->
                    
                            <!-- weibo -->
                            
                                    <!-- facebook -->
                                    

        </div>
    </div>
    

                        <!-- 公告栏 -->
                        

                </div>
            </div>



            <div class="site-footer">
  Powered by <a href="https://github.com/getgridea/gridea" target="_blank">Gridea</a> | 
  <a class="rss" href="https://zoengzihaam.github.io/atom.xml" target="_blank">RSS</a>
</div>

<script>
  hljs.initHighlightingOnLoad()
</script>

    </div>
    <script>
        $('#sidebar').stickySidebar({
            topSpacing: 80,
            // bottomSpacing: 60
        });
    </script>
</body>

</html>