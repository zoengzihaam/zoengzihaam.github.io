<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
    <id>https://zoengzihaam.github.io</id>
    <title>å·æ¯›</title>
    <updated>2021-04-02T08:49:56.508Z</updated>
    <generator>https://github.com/jpmonette/feed</generator>
    <link rel="alternate" href="https://zoengzihaam.github.io"/>
    <link rel="self" href="https://zoengzihaam.github.io/atom.xml"/>
    <subtitle>æ²¡æœ‰æ’¤é€€å¯è¨€ã€‚</subtitle>
    <logo>https://zoengzihaam.github.io/images/avatar.png</logo>
    <icon>https://zoengzihaam.github.io/favicon.ico</icon>
    <rights>All rights reserved 2021, å·æ¯›</rights>
    <entry>
        <title type="html"><![CDATA[Ubuntu è¿œç¨‹rootç™»å½•]]></title>
        <id>https://zoengzihaam.github.io/post/21/</id>
        <link href="https://zoengzihaam.github.io/post/21/">
        </link>
        <updated>2021-04-02T08:48:48.000Z</updated>
        <content type="html"><![CDATA[<h1 id="ubuntuè¿œç¨‹rootç™»å½•">Ubuntuè¿œç¨‹rootç™»å½•</h1>
<blockquote>
<p>ä½ä»·è´­ä¹°äº†ä¸‰å¹´çš„è…¾è®¯äº‘vpsï¼Œå°è¯•è¿œç¨‹sshç™»å½•çš„æ—¶å€™ï¼Œå‘ç°æ— æ³•ä½¿ç”¨rootç”¨æˆ·ç™»å½•ï¼Œåªèƒ½ä½¿ç”¨é»˜è®¤çš„ç”¨æˆ·åï¼Œè¿™å°±å¤§å¤§å¢åŠ äº†ä½¿ç”¨æ—¶å€™çš„æ“ä½œæ­¥éª¤ï¼Œäºæ˜¯å°±å°è¯•ç»™Ubuntuèµ‹äºˆè¿œç¨‹rootä½¿ç”¨çš„æƒé™ã€‚</p>
</blockquote>
<h2 id="å¢åŠ ä¸€ä¸ªrootå¯†ç ">å¢åŠ ä¸€ä¸ªrootå¯†ç </h2>
<blockquote>
<p>é»˜è®¤ä¸»æœºæ˜¯æ²¡æœ‰rootå¯†ç ï¼Œæˆ‘ä»¬è¿™é‡Œæ–°å¢ä¸€ä¸ªrootçš„å¯†ç ã€‚</p>
</blockquote>
<p>å»ºè®®ä½¿ç”¨ç›¸åŒä½†ä¸ç®€å•çš„å¯†ç ï¼Œé˜²æ­¢å¿˜è®°ä¹Ÿé˜²æ­¢å¤ªç®€å•å‡ºç°æ•°æ®æŸå¤±ã€‚</p>
<pre><code class="language-shell">sudo passwd root
</code></pre>
<p>è¿™é‡Œéœ€è¦è¾“å…¥ä¸¤æ¬¡å¯†ç ï¼Œå‡ºç°ä¿®æ”¹æˆåŠŸå³å¯ã€‚</p>
<h2 id="ä¿®æ”¹sshdé…ç½®">ä¿®æ”¹sshdé…ç½®</h2>
<blockquote>
<p><code>sshd</code>ä¸­é»˜è®¤ä¸ä½¿ç”¨ROOTç™»å½•ï¼Œä¿®æ”¹<code>sshd</code>çš„é…ç½®æ–‡ä»¶æ¥å¼€å¯ä¸€ä¸‹ã€‚</p>
</blockquote>
<ol>
<li>
<p>ä¿®æ”¹<code>sshd</code>çš„é…ç½®æ–‡ä»¶</p>
<pre><code class="language-shell">sudo vim /etc/ssh/sshd_config
</code></pre>
</li>
<li>
<p>ä¿®æ”¹ <code>PermitRootLogin</code> çš„é»˜è®¤å‚æ•°</p>
<p>è¿™é‡Œæˆ‘åœ¨åŸå±æ€§ä¸‹é¢æ·»åŠ ç›¸åŒçš„å±æ€§ï¼Œä¿ç•™äº†åŸæ¥çš„é…ç½®å†…å®¹ã€‚</p>
<figure data-type="image" tabindex="1"><img src="https://gitee.com/zoengzihaam/ImgBed/raw/master/images/20210402163653.png" alt="image-20210402163653587" loading="lazy"></figure>
</li>
<li>
<p>é‡å¯<code>ssh</code>æœåŠ¡</p>
<pre><code class="language-shell">sudo service ssh restart
</code></pre>
</li>
</ol>
<p>è‡ªæ­¤ï¼Œè¿™å°vpsä¸»æœºå°±å¯ä»¥è¿œç¨‹è¿›è¡Œrootç™»å½•ã€‚</p>
]]></content>
    </entry>
    <entry>
        <title type="html"><![CDATA[å…³äºWIN10ä¸‹å¯åŠ¨åº”ç”¨ç¨‹åºå‡ºç°MSVCR110.dllç¼ºå¤±çš„è§£å†³åŠæ³•]]></title>
        <id>https://zoengzihaam.github.io/post/20/</id>
        <link href="https://zoengzihaam.github.io/post/20/">
        </link>
        <updated>2021-04-02T07:49:15.000Z</updated>
        <content type="html"><![CDATA[<h1 id="å…³äºwin10ä¸‹å¯åŠ¨åº”ç”¨ç¨‹åºå‡ºç°msvcr110dllç¼ºå¤±çš„è§£å†³åŠæ³•">å…³äºWIN10ä¸‹å¯åŠ¨åº”ç”¨ç¨‹åºå‡ºç°MSVCR110.dllç¼ºå¤±çš„è§£å†³åŠæ³•</h1>
<blockquote>
<p>ç”±äºæ›´æ¢äº†ç”µè„‘ç¡¬ä»¶ï¼Œä»‹äºæœ‰å·¥ä½œç¯å¢ƒçš„åŸå› ï¼Œæ²¡æœ‰å½»åº•çš„é‡è£…ç³»ç»Ÿï¼Œè€Œæ˜¯ä½¿ç”¨WIN10è‡ªå¸¦çš„é‡ç½®ï¼Œå¯¼è‡´é‡è£…å…¶ä»–è½¯ä»¶çš„æ—¶å€™ï¼Œæ‰“å¼€å‡ºç°XXX.dllç¼ºå¤±æ— æ³•å¯åŠ¨åº”ç”¨ç¨‹åºã€‚</p>
</blockquote>
<h2 id="é—®é¢˜">é—®é¢˜</h2>
<p>å®‰è£…<code>xshell</code>ä¹‹åï¼Œå¯åŠ¨æ—¶å‡ºç°ï¼š</p>
<p class='katex-block'><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi mathvariant="normal">ç”±</mi><mi mathvariant="normal">äº</mi><mi mathvariant="normal">æ‰¾</mi><mi mathvariant="normal">ä¸</mi><mi mathvariant="normal">åˆ°</mi><mi>M</mi><mi>S</mi><mi>V</mi><mi>C</mi><mi>R</mi><mn>110.</mn><mi>d</mi><mi>l</mi><mi>l</mi><mi mathvariant="normal">ï¼Œ</mi><mi mathvariant="normal">æ— </mi><mi mathvariant="normal">æ³•</mi><mi mathvariant="normal">ç»§</mi><mi mathvariant="normal">ç»­</mi><mi mathvariant="normal">æ‰§</mi><mi mathvariant="normal">è¡Œ</mi><mi mathvariant="normal">ä»£</mi><mi mathvariant="normal">ç </mi><mi mathvariant="normal">ã€‚</mi><mi mathvariant="normal">é‡</mi><mi mathvariant="normal">æ–°</mi><mi mathvariant="normal">å®‰</mi><mi mathvariant="normal">è£…</mi><mi mathvariant="normal">ç¨‹</mi><mi mathvariant="normal">åº</mi><mi mathvariant="normal">å¯</mi><mi mathvariant="normal">èƒ½</mi><mi mathvariant="normal">ä¼š</mi><mi mathvariant="normal">è§£</mi><mi mathvariant="normal">å†³</mi><mi mathvariant="normal">æ­¤</mi><mi mathvariant="normal">é—®</mi><mi mathvariant="normal">é¢˜</mi><mi mathvariant="normal">ã€‚</mi></mrow><annotation encoding="application/x-tex">ç”±äºæ‰¾ä¸åˆ° MSVCR110.dllï¼Œæ— æ³•ç»§ç»­æ‰§è¡Œä»£ç ã€‚é‡æ–°å®‰è£…ç¨‹åºå¯èƒ½ä¼šè§£å†³æ­¤é—®é¢˜ã€‚
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.69444em;vertical-align:0em;"></span><span class="mord cjk_fallback">ç”±</span><span class="mord cjk_fallback">äº</span><span class="mord cjk_fallback">æ‰¾</span><span class="mord cjk_fallback">ä¸</span><span class="mord cjk_fallback">åˆ°</span><span class="mord mathdefault" style="margin-right:0.10903em;">M</span><span class="mord mathdefault" style="margin-right:0.05764em;">S</span><span class="mord mathdefault" style="margin-right:0.22222em;">V</span><span class="mord mathdefault" style="margin-right:0.07153em;">C</span><span class="mord mathdefault" style="margin-right:0.00773em;">R</span><span class="mord">1</span><span class="mord">1</span><span class="mord">0</span><span class="mord">.</span><span class="mord mathdefault">d</span><span class="mord mathdefault" style="margin-right:0.01968em;">l</span><span class="mord mathdefault" style="margin-right:0.01968em;">l</span><span class="mord cjk_fallback">ï¼Œ</span><span class="mord cjk_fallback">æ— </span><span class="mord cjk_fallback">æ³•</span><span class="mord cjk_fallback">ç»§</span><span class="mord cjk_fallback">ç»­</span><span class="mord cjk_fallback">æ‰§</span><span class="mord cjk_fallback">è¡Œ</span><span class="mord cjk_fallback">ä»£</span><span class="mord cjk_fallback">ç </span><span class="mord cjk_fallback">ã€‚</span><span class="mord cjk_fallback">é‡</span><span class="mord cjk_fallback">æ–°</span><span class="mord cjk_fallback">å®‰</span><span class="mord cjk_fallback">è£…</span><span class="mord cjk_fallback">ç¨‹</span><span class="mord cjk_fallback">åº</span><span class="mord cjk_fallback">å¯</span><span class="mord cjk_fallback">èƒ½</span><span class="mord cjk_fallback">ä¼š</span><span class="mord cjk_fallback">è§£</span><span class="mord cjk_fallback">å†³</span><span class="mord cjk_fallback">æ­¤</span><span class="mord cjk_fallback">é—®</span><span class="mord cjk_fallback">é¢˜</span><span class="mord cjk_fallback">ã€‚</span></span></span></span></span></p>
<p class='katex-block'><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi mathvariant="normal">ç”±</mi><mi mathvariant="normal">äº</mi><mi mathvariant="normal">æ‰¾</mi><mi mathvariant="normal">ä¸</mi><mi mathvariant="normal">åˆ°</mi><mi>M</mi><mi>S</mi><mi>V</mi><mi>C</mi><mi>P</mi><mn>110.</mn><mi>d</mi><mi>l</mi><mi>l</mi><mi mathvariant="normal">ï¼Œ</mi><mi mathvariant="normal">æ— </mi><mi mathvariant="normal">æ³•</mi><mi mathvariant="normal">ç»§</mi><mi mathvariant="normal">ç»­</mi><mi mathvariant="normal">æ‰§</mi><mi mathvariant="normal">è¡Œ</mi><mi mathvariant="normal">ä»£</mi><mi mathvariant="normal">ç </mi><mi mathvariant="normal">ã€‚</mi><mi mathvariant="normal">é‡</mi><mi mathvariant="normal">æ–°</mi><mi mathvariant="normal">å®‰</mi><mi mathvariant="normal">è£…</mi><mi mathvariant="normal">ç¨‹</mi><mi mathvariant="normal">åº</mi><mi mathvariant="normal">å¯</mi><mi mathvariant="normal">èƒ½</mi><mi mathvariant="normal">ä¼š</mi><mi mathvariant="normal">è§£</mi><mi mathvariant="normal">å†³</mi><mi mathvariant="normal">æ­¤</mi><mi mathvariant="normal">é—®</mi><mi mathvariant="normal">é¢˜</mi><mi mathvariant="normal">ã€‚</mi></mrow><annotation encoding="application/x-tex">ç”±äºæ‰¾ä¸åˆ° MSVCP110.dllï¼Œæ— æ³•ç»§ç»­æ‰§è¡Œä»£ç ã€‚é‡æ–°å®‰è£…ç¨‹åºå¯èƒ½ä¼šè§£å†³æ­¤é—®é¢˜ã€‚
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.69444em;vertical-align:0em;"></span><span class="mord cjk_fallback">ç”±</span><span class="mord cjk_fallback">äº</span><span class="mord cjk_fallback">æ‰¾</span><span class="mord cjk_fallback">ä¸</span><span class="mord cjk_fallback">åˆ°</span><span class="mord mathdefault" style="margin-right:0.10903em;">M</span><span class="mord mathdefault" style="margin-right:0.05764em;">S</span><span class="mord mathdefault" style="margin-right:0.22222em;">V</span><span class="mord mathdefault" style="margin-right:0.07153em;">C</span><span class="mord mathdefault" style="margin-right:0.13889em;">P</span><span class="mord">1</span><span class="mord">1</span><span class="mord">0</span><span class="mord">.</span><span class="mord mathdefault">d</span><span class="mord mathdefault" style="margin-right:0.01968em;">l</span><span class="mord mathdefault" style="margin-right:0.01968em;">l</span><span class="mord cjk_fallback">ï¼Œ</span><span class="mord cjk_fallback">æ— </span><span class="mord cjk_fallback">æ³•</span><span class="mord cjk_fallback">ç»§</span><span class="mord cjk_fallback">ç»­</span><span class="mord cjk_fallback">æ‰§</span><span class="mord cjk_fallback">è¡Œ</span><span class="mord cjk_fallback">ä»£</span><span class="mord cjk_fallback">ç </span><span class="mord cjk_fallback">ã€‚</span><span class="mord cjk_fallback">é‡</span><span class="mord cjk_fallback">æ–°</span><span class="mord cjk_fallback">å®‰</span><span class="mord cjk_fallback">è£…</span><span class="mord cjk_fallback">ç¨‹</span><span class="mord cjk_fallback">åº</span><span class="mord cjk_fallback">å¯</span><span class="mord cjk_fallback">èƒ½</span><span class="mord cjk_fallback">ä¼š</span><span class="mord cjk_fallback">è§£</span><span class="mord cjk_fallback">å†³</span><span class="mord cjk_fallback">æ­¤</span><span class="mord cjk_fallback">é—®</span><span class="mord cjk_fallback">é¢˜</span><span class="mord cjk_fallback">ã€‚</span></span></span></span></span></p>
<h2 id="å¯»æ‰¾è§£å†³åŠæ³•">å¯»æ‰¾è§£å†³åŠæ³•</h2>
<p>åœ¨å¾®è½¯çš„ç¤¾åŒºäº¤æµä¸­å‘ç°é‡åˆ°ç›¸åŒé—®é¢˜çš„ç”¨æˆ·ï¼Œ<code>Microsoft ä»£ç† å®¡é˜…äºº</code>ç»™å‡ºçš„è§£å†³æ–¹æ³•æ˜¯ï¼š</p>
<figure data-type="image" tabindex="1"><img src="https://gitee.com/zoengzihaam/ImgBed/raw/master/images/20210402154150.png" alt="image-20210402154150081" loading="lazy"></figure>
<p>æˆ‘æ ¹æ®è§£å†³åŠæ³•ï¼Œå®‰è£…äº†æŒ‡å®šç‰ˆæœ¬çš„VC++è¿è¡Œåº“</p>
<figure data-type="image" tabindex="2"><img src="https://gitee.com/zoengzihaam/ImgBed/raw/master/images/20210402154356.png" alt="image-20210402154356642" loading="lazy"></figure>
<p>é‡æ–°è¿è¡Œ<code>xshell</code>ä½†æ˜¯è¿˜æ˜¯å‡ºç°äº†æ–‡ä»¶ç¼ºå¤±çš„æç¤ºï¼Œæˆ‘å°†è½¯ä»¶é‡è£…ä»¥åŠç”µè„‘é‡å¯ï¼Œå‡æ— æ³•è§£å†³æ­¤é—®é¢˜ã€‚</p>
<h2 id="æœ€ç»ˆæ–¹æ³•">æœ€ç»ˆæ–¹æ³•</h2>
<p>å¦‚æœä½ çš„ç”µè„‘ç³»ç»Ÿæ˜¯X64çš„ï¼Œåˆ™éœ€è¦å°† <code>vcredist_x64.exe</code> ä»¥åŠ <code>vcredist_x86.exe</code> å…¨éƒ¨å‹¾é€‰å¹¶å®‰è£…ï¼Œå†æ¬¡æ‰“å¼€åº”ç”¨ç¨‹åºè§£å†³æŠ¥é”™é—®é¢˜ã€‚</p>
<figure data-type="image" tabindex="3"><img src="https://gitee.com/zoengzihaam/ImgBed/raw/master/images/20210402154626.png" alt="image-20210402154625922" loading="lazy"></figure>
<p><strong>å¾®è½¯Visual C++ è¿è¡Œåº“ä¸‹è½½åœ°å€ï¼š</strong></p>
<p><code>https://www.microsoft.com/en-us/download/details.aspx?id=30679</code></p>
]]></content>
    </entry>
    <entry>
        <title type="html"><![CDATA[NetflixDNSè§£é”]]></title>
        <id>https://zoengzihaam.github.io/post/netflixdns-jie-suo/</id>
        <link href="https://zoengzihaam.github.io/post/netflixdns-jie-suo/">
        </link>
        <updated>2021-01-12T06:32:04.000Z</updated>
        <content type="html"><![CDATA[<h1 id="netflixdnsè§£é”">NetflixDNSè§£é”</h1>
<blockquote>
<p>ç”±äºNetflixçš„ç‰ˆæƒé—®é¢˜ï¼Œä½¿ç”¨ä¸€èˆ¬çš„ä»£ç†æœåŠ¡è·¨åŒºçœ‹å‰§æ—¶ä¼šè¢« Netflix æ£€æµ‹åˆ°å¹¶é˜»æ­¢ï¼Œå½“æˆ‘ä»¬ä½¿ç”¨çš„vpsä¸èƒ½è§‚çœ‹Netflixçš„æ—¶å€™ï¼Œæˆ‘ä»¬å¯ä»¥é€‰æ‹©è´­ä¹°ä¾¿å®œå¤§ç¢—çš„vpsæ¥è¾…åŠ©è§£é”ä¸èƒ½æŸ¥çœ‹Netflixçš„vpsã€‚</p>
</blockquote>
<h2 id="å‡†å¤‡å·¥ä½œ">å‡†å¤‡å·¥ä½œ</h2>
<p>æ­£å¼å¼€å§‹ä¹‹å‰ï¼Œæˆ‘ä»¬éœ€è¦åšä¸€äº›åŸºæœ¬çš„å‡†å¤‡ï¼Œä½ è‡³å°‘éœ€è¦è¿™äº›ä¸œè¥¿ï¼š</p>
<ul>
<li>æ”¯æŒ Netflix çš„ä»£ç†æœåŠ¡</li>
<li>ä¸æ”¯æŒ Netflix çš„ä»£ç†æœåŠ¡</li>
<li>Netflixè®¢é˜…</li>
</ul>
<p><strong>å°±ç›®å‰è€Œè¨€ï¼Œç¾åŒºåº”è¯¥æ˜¯ç›®å‰å‰§é›†èµ„æºæœ€ä¸°å¯Œçš„åœ°åŒºï¼Œä½†æ˜¯æ ¹æ®æœ¬äººäº²æµ‹ï¼Œç¾åŒºçš„èµ„æºå¹¶ä¸ç¬¦åˆå›½äººçš„è§‚çœ‹é£æ ¼ï¼Œä¸ªäººæ¯”è¾ƒæ¨èé¦™æ¸¯ã€‚</strong></p>
<h2 id="ä½¿ç”¨dnsmasqè§£é”netflixå¥ˆé£æµåª’ä½“æœåŠ¡">ä½¿ç”¨Dnsmasqè§£é”Netflixï¼ˆå¥ˆé£ï¼‰æµåª’ä½“æœåŠ¡</h2>
<p>è¿™é‡Œå€ŸåŠ©äº†<a href="https://www.moeelf.com/archives/23.html">èŒç²¾çµ</a> çš„è„šæœ¬å®ç°ï¼Œè¿™é‡Œæ„Ÿè°¢èŒç²¾çµã€‚</p>
<p><strong>å®‰è£…æ–¹æ³•ï¼š</strong></p>
<p>æ”¯æŒ Netflix çš„ä»£ç†vpså®‰è£…</p>
<pre><code class="language-shell">wget --no-check-certificate -O dnsmasq_sniproxy.sh https://raw.githubusercontent.com/myxuchangbin/dnsmasq_sniproxy_install/master/dnsmasq_sniproxy.sh &amp;&amp; bash dnsmasq_sniproxy.sh -f
</code></pre>
<p><strong>å¸è½½æ–¹æ³•ï¼š</strong></p>
<pre><code class="language-shell">wget --no-check-certificate -O dnsmasq_sniproxy.sh https://raw.githubusercontent.com/myxuchangbin/dnsmasq_sniproxy_install/master/dnsmasq_sniproxy.sh &amp;&amp; bash dnsmasq_sniproxy.sh -u
</code></pre>
<p><strong>ä½¿ç”¨æ–¹æ³•ï¼š</strong></p>
<p>å°†<code>ä¸æ”¯æŒ Netflix çš„ä»£ç†VPS</code>çš„DNSåœ°å€ä¿®æ”¹ä¸º<code>æ”¯æŒ Netflix çš„ä»£ç†vps</code>çš„IPå°±å¯ä»¥äº†ï¼Œå¦‚æœä¸èƒ½ç”¨ï¼Œè®°å¾—åªä¿ç•™ä¸€ä¸ªDNSåœ°å€è¯•ä¸€ä¸‹ã€‚</p>
<p>âš ï¸ï¼šé˜²æ­¢æ»¥ç”¨ï¼Œå»ºè®®ä¸è¦éšæ„å…¬å¸ƒIPåœ°å€ï¼Œæˆ–ä½¿ç”¨é˜²ç«å¢™åšå¥½é™åˆ¶å·¥ä½œã€‚</p>
<p><strong>è°ƒè¯•æ’é”™ï¼š</strong></p>
<ul>
<li>ç¡®è®¤sniproxyæœ‰æ•ˆè¿è¡Œ</li>
</ul>
<p>é‡å¯sniå‘½ä»¤ï¼šsystemctl restart sniproxy</p>
<p>å¦‚æœsniä¸åœ¨è¿è¡Œï¼Œå¯æ£€æŸ¥é…ç½®/etc/sniproxy.confï¼Œé¿å…ssã€nginxæˆ–è€…å…¶ä»–ç¨‹åºç›‘å¬80,443ï¼Œå¯å°†å…¶é…ç½®æ–‡ä»¶çš„80æ›´æ”¹ä¸º801ç­‰ã€‚ 443ç«¯å£å¿…é¡»ç»™sniç›‘å¬æ”¾è¡Œï¼ŒæŸ¥çœ‹ï¼šnetstat -tlunp|grep 443</p>
<ul>
<li>ç¡®è®¤é˜²ç«å¢™æ”¾è¡Œ443,53</li>
</ul>
<p>è°ƒè¯•å¯ç›´æ¥å…³é—­é˜²ç«å¢™ systemctl stop firewalld.service</p>
<p>é˜¿é‡Œäº‘/è°·æ­Œäº‘/AWSç­‰å¤–éƒ¨é˜²ç«å¢™æ”¾è¡Œ å¯é€šè¿‡å…¶ä»–æœåŠ¡å™¨ telnet vpsip 53 ä»¥åŠ telnet vpsip 443 è¿›è¡Œæµ‹è¯•</p>
<ul>
<li>è§£æåŸŸå</li>
</ul>
<p>å°è¯•ç”¨å…¶ä»–æœåŠ¡å™¨é…ç½®å®Œæ¯•dnsåï¼Œè§£æåŸŸåï¼šnslookup <a href="https://www.moeelf.com/tag/netflix">netflix</a>.com åˆ¤æ–­IPæ˜¯å¦æ˜¯NETFLIXä»£ç†æœºå™¨IP å¦‚æœä¸å­˜åœ¨nslookupå‘½ä»¤ï¼ŒCENTOSå®‰è£…ï¼šyum install -y bind-utilsï¼ŒDEBIANå®‰è£…ï¼šapt-get -y install dnsutils</p>
<h2 id="ä¸€é”®è„šæœ¬ä¿®æ”¹æ¨èä¿®æ”¹æ–¹å¼">ä¸€é”®è„šæœ¬ä¿®æ”¹æ¨èä¿®æ”¹æ–¹å¼ï¼š</h2>
<blockquote>
<p>ä¸€é”®è„šæœ¬å¾ˆå¤šéƒ½ä¼šè‡ªå¸¦dnsæœåŠ¡ï¼Œä¼šå½±å“æµåª’ä½“çš„dnsè§£é”ã€‚</p>
</blockquote>
<p><strong>ä¿®æ”¹æ–¹å¼ï¼š</strong></p>
<pre><code class="language-shell">vi /etc/v2ray/config.json
</code></pre>
<p>æ‰¾åˆ°DNS</p>
<pre><code class="language-shell">&quot;dns&quot;: {
        &quot;servers&quot;: [
            {
                &quot;address&quot;: &quot;xxx.xxx.xxx.xxx&quot;,     //æ­¤å¤„ä¸ºæ”¯æŒ Netflix çš„ä»£ç†VPS
                &quot;port&quot;: 53,
                &quot;domains&quot;: [
                    &quot;domain:netflix.com&quot;,
                    &quot;domain:netflix.net&quot;,
                    &quot;domain:nflximg.net&quot;,
                    &quot;domain:nflxvideo.net&quot;,
                    &quot;domain:nflxso.net&quot;,
                    &quot;domain:nflxext.com&quot;
                ]
            },
            &quot;localhost&quot;
        ]
    }
</code></pre>
<p>ä¿®æ”¹é…ç½®å®Œæˆä»¥åï¼Œè¯·é‡å¯ä½ çš„V2RAYæœåŠ¡ï¼Œæˆ–æ˜¯é‡å¯VPSã€‚</p>
<h2 id="ä½¿ç”¨åˆ†æµè®©ä¸åŒçš„æµåª’ä½“èµ°ä¸åŒçš„dns">ä½¿ç”¨åˆ†æµï¼Œè®©ä¸åŒçš„æµåª’ä½“èµ°ä¸åŒçš„DNS</h2>
<p><strong>ä¿®æ”¹æ–¹æ³•ï¼š</strong></p>
<pre><code class="language-shell">&quot;dns&quot;: {
        &quot;servers&quot;: [
            {
                &quot;address&quot;: &quot;æ”¯æŒNetflixçš„ä»£ç†VPS&quot;,
                &quot;port&quot;: 53,
                &quot;domains&quot;: [
                    &quot;domain:netflix.com&quot;,
                    &quot;domain:netflix.net&quot;,
                    &quot;domain:nflximg.net&quot;,
                    &quot;domain:nflxvideo.net&quot;,
                    &quot;domain:nflxso.net&quot;,
                    &quot;domain:nflxext.com&quot;
                ]
            },
            {
                &quot;address&quot;: &quot;æ”¯æŒçš„ä»£ç†VPS&quot;,
                &quot;port&quot;: 53,
                &quot;domains&quot;: [
                    &quot;domain:gamer2-cds.cdn.hinet.net&quot;,
                    &quot;domain:gamer-cds.cdn.hinet.net&quot;,
                    &quot;domain:gamer.com.tw&quot;,
                    &quot;domain:i2.bahamut.com.tw&quot;,
                    &quot;domain:app-measurement.com&quot;
                ]
            },
            {
                &quot;address&quot;: &quot;æ”¯æŒçš„ä»£ç†VPS&quot;,
                &quot;port&quot;: 53,
                &quot;domains&quot;: [
                    &quot;domain:bilibili.com&quot;
                ]
            },
            &quot;localhost&quot;
        ]
    }
</code></pre>
<h2 id="åŸŸåè§„åˆ™">åŸŸåè§„åˆ™</h2>
<h3 id="netflix"><strong>Netflix</strong></h3>
<pre><code class="language-shell">netflix.com
netflix.net
nflximg.net
nflximg.com
nflxvideo.net
nflxso.net
nflxext.com
</code></pre>
<h3 id="spotify"><strong>Spotify</strong></h3>
<pre><code class="language-shell">scdn.co
spotify.com
spoti.fi
</code></pre>
<h3 id="bilibili"><strong>bilibili</strong></h3>
<pre><code class="language-shell">bilibili.com
</code></pre>
<h3 id="åŠ¨ç”»ç–¯"><strong>åŠ¨ç”»ç–¯</strong></h3>
<pre><code class="language-shell">gamer-cds.cdn.hinet.net
gamer2-cds.cdn.hinet.net
gamer.com.tw
i2.bahamut.com.tw
app-measurement.com
</code></pre>
<h3 id="line"><strong>Line</strong></h3>
<pre><code class="language-shell">lin.ee
line.me
linenaver.jp
line-apps.com
line-cdn.net
line-scdn.net
linetv.tw
cloudfront.net
</code></pre>
<h3 id="fox"><strong>Fox+</strong></h3>
<pre><code class="language-shell">fox.com
foxdng.com
foxnow.com
foxplus.com
foxplay.com
</code></pre>
<h3 id="bbc"><strong>BBC</strong></h3>
<pre><code class="language-shell">bbc.co
bbc.com
co.uk
llnwd.net
akamaized.net
</code></pre>
<h3 id="hulu"><strong>Hulu</strong></h3>
<pre><code class="language-shell">hulu.com
huluim.com
</code></pre>
<h3 id="hboç¾åŒº"><strong>hbo(ç¾åŒº)</strong></h3>
<pre><code class="language-shell">hbonow.com
hbogo.com
hbomax.com
hbo.com
</code></pre>
<h3 id="disney"><strong>disney</strong></h3>
<pre><code class="language-shell">disney.com
disneyjunior.com
disneyplus.com
disney-plus.net
dssott.com
bamgrid.com
amazonaws.com
go.com
</code></pre>
]]></content>
    </entry>
    <entry>
        <title type="html"><![CDATA[ROSåŒè½¯è·¯ç”±ä½¿ç”¨jumpå®ç°å…¬ç½‘ç«¯å£è½¬å‘]]></title>
        <id>https://zoengzihaam.github.io/post/19/</id>
        <link href="https://zoengzihaam.github.io/post/19/">
        </link>
        <updated>2020-11-25T15:57:44.000Z</updated>
        <content type="html"><![CDATA[<blockquote>
<p>ç”±äºä½¿ç”¨äº†åŒè½¯è·¯ç”±ï¼ŒROSä¸Šè®¾ç½®upnpï¼Œç«¯å£ä¸èƒ½å®ç°è‡ªåŠ¨è½¬å‘ï¼Œæ‰€ä»¥ä½¿ç”¨ROSçš„jumpæ–¹å¼æ¥å®ç°è¿™ä¸ªåŠŸèƒ½ã€‚</p>
</blockquote>
<ol>
<li>é¦–å…ˆåœ¨ROSåŠŸèƒ½ç•Œé¢æ‰“å¼€ IP â†’ Firewall â†’ NAT</li>
</ol>
<figure data-type="image" tabindex="1"><img src="https://gitee.com/zoengzihaam/ImgBed/raw/master/images/image-20201125232043901.png" alt="image-20201125232043901" loading="lazy"></figure>
<ol start="2">
<li>
<p>æ·»åŠ ä¸€ä¸ª NAT è§„åˆ™ (è®¾ç½®jump)</p>
<p>1ï¸âƒ£ General è®¾ç½®</p>
<figure data-type="image" tabindex="2"><img src="https://gitee.com/zoengzihaam/ImgBed/raw/master/images/image-20201125232323939.png" alt="image-20201125232323939" loading="lazy"></figure>
<p>2ï¸âƒ£ Action è®¾ç½®</p>
<figure data-type="image" tabindex="3"><img src="https://gitee.com/zoengzihaam/ImgBed/raw/master/images/image-20201125232515115.png" alt="image-20201125232515115" loading="lazy"></figure>
</li>
<li>
<p>è®¾ç½®éœ€è¦çš„ç«¯å£è½¬å‘</p>
<p>1ï¸âƒ£ æ·»åŠ ä¸€ä¸ª NAT è§„åˆ™ (General è®¾ç½®)</p>
<figure data-type="image" tabindex="4"><img src="https://gitee.com/zoengzihaam/ImgBed/raw/master/images/image-20201125233019443.png" alt="image-20201125233019443" loading="lazy"></figure>
<p>2ï¸âƒ£ Action è®¾ç½®</p>
<figure data-type="image" tabindex="5"><img src="https://gitee.com/zoengzihaam/ImgBed/raw/master/images/image-20201125233236947.png" alt="image-20201125233236947" loading="lazy"></figure>
<p>åˆ°æ­¤ç«¯å£è½¬å‘å°±è®¾ç½®å®Œæˆã€‚</p>
</li>
<li>
<p>ç•ªå¤–</p>
<blockquote>
<p>ç”±äºå…¬ç½‘æ¯æ¬¡æ‹¨å·ï¼Œå¯èƒ½å¯¼è‡´å…¬ç½‘åœ°å€ä¼šå‘ç”Ÿæ”¹å˜ï¼Œè¿™é‡Œä½¿ç”¨ROSçš„è„šæœ¬æ¥å®ç°è‡ªåŠ¨è®¾ç½®JUMPé‡Œé¢çš„å…¬ç½‘åœ°å€ã€‚</p>
</blockquote>
<p>1ï¸âƒ£ åœ¨ROSç•Œé¢ System â†’ scripts æ·»åŠ ä¸€ä¸ªè„šæœ¬</p>
<figure data-type="image" tabindex="6"><img src="https://gitee.com/zoengzihaam/ImgBed/raw/master/images/image-20201125234013781.png" alt="image-20201125234013781" loading="lazy"></figure>
<p>2ï¸âƒ£ è®¾ç½®è„šæœ¬</p>
<figure data-type="image" tabindex="7"><img src="https://gitee.com/zoengzihaam/ImgBed/raw/master/images/image-20201125234414683.png" alt="image-20201125234414683" loading="lazy"></figure>
<p><code>scriptè„šæœ¬ä»£ç ï¼š</code></p>
<pre><code class="language-shell">:global addold
:global addnew
 :set addnew [/interface get [/interface find name=&quot;pppoe-out1&quot;] running]
 :if ($addnew=true) do={
  :set addold [/ip address get [/ip address find dynamic=yes interface=&quot;pppoe-out1&quot;] address]
  :set addold [:pick $addold 0 ([:len $addold ] -3)]
   /ip firewall nat set [/ip firewall nat find comment=&quot;dynamic_nat&quot;] dst-address=$addold
}
</code></pre>
<p>3ï¸âƒ£ è®¾ç½®ä¸€ä¸ªå®šæ—¶Profile</p>
<p>ROSç•Œé¢ â†’ PPP â†’ Profiles æ·»åŠ ä¸€ä¸ªæ–°çš„Profile</p>
<figure data-type="image" tabindex="8"><img src="https://gitee.com/zoengzihaam/ImgBed/raw/master/images/image-20201125234658556.png" alt="image-20201125234658556" loading="lazy"></figure>
<p>è®¾ç½®Profiles</p>
<figure data-type="image" tabindex="9"><img src="https://gitee.com/zoengzihaam/ImgBed/raw/master/images/image-20201125234911018.png" alt="image-20201125234911018" loading="lazy"></figure>
<p>è®¾ç½® Scripts</p>
<figure data-type="image" tabindex="10"><img src="https://gitee.com/zoengzihaam/ImgBed/raw/master/images/image-20201125235117699.png" alt="image-20201125235117699" loading="lazy"></figure>
<p><code>profileè„šæœ¬ä»£ç ï¼š</code></p>
<pre><code class="language-shell">delay 3s
:execute &quot;dynamic_nat&quot;
</code></pre>
</li>
</ol>
<p>ğŸŒˆä»¥ä¸Šï¼Œå…¬ç½‘ç«¯å£è½¬å‘çš„jumpè®¾ç½®å…¨éƒ¨è®¾ç½®å®Œæ¯•ï¼Œå¦‚æœè¿‡ç¨‹æœ‰é”™è¯¯çš„åœ°æ–¹ï¼Œè¿˜è¯·å„ä½æŒ‡æ•™ä¸€èµ·è®¨è®ºï¼Œè°¢è°¢ã€‚ğŸ’¨</p>
]]></content>
    </entry>
    <entry>
        <title type="html"><![CDATA[dockerå¼€æœºè‡ªå¯]]></title>
        <id>https://zoengzihaam.github.io/post/16/</id>
        <link href="https://zoengzihaam.github.io/post/16/">
        </link>
        <updated>2020-07-25T14:51:11.000Z</updated>
        <content type="html"><![CDATA[<h1 id="dockerå¼€æœºè‡ªå¯">dockerå¼€æœºè‡ªå¯</h1>
<h2 id="ä¸€-dockeræœåŠ¡è®¾ç½®è‡ªåŠ¨å¯åŠ¨">ä¸€ã€dockeræœåŠ¡è®¾ç½®è‡ªåŠ¨å¯åŠ¨</h2>
<blockquote>
<p>é€‚ç”¨äºyumå®‰è£…çš„å„ç§æœåŠ¡</p>
</blockquote>
<ul>
<li>æŸ¥çœ‹å·²å¯åŠ¨çš„æœåŠ¡</li>
</ul>
<pre><code class="language-shell">systemctl list-units --type=service
</code></pre>
<ul>
<li>æŸ¥çœ‹æ˜¯å¦è®¾ç½®å¼€æœºå¯åŠ¨</li>
</ul>
<pre><code class="language-shell">systemctl list-unit-files | grep enable
</code></pre>
<ul>
<li>è®¾ç½®å¼€æœºå¯åŠ¨</li>
</ul>
<pre><code class="language-shell">systemctl enable docker.service
</code></pre>
<ul>
<li>å…³é—­å¼€æœºå¯åŠ¨</li>
</ul>
<pre><code class="language-shell">systemctl disable docker.service
</code></pre>
<h2 id="äºŒ-dockerå®¹å™¨è®¾ç½®è‡ªåŠ¨å¯åŠ¨">äºŒã€dockerå®¹å™¨è®¾ç½®è‡ªåŠ¨å¯åŠ¨</h2>
<ul>
<li>å¯åŠ¨æ—¶åŠ  --restart=always</li>
</ul>
<pre><code class="language-shell">docker run tomcat -it -d -p 8080:8080 --restart=always
</code></pre>
<ul>
<li>
<p>å¦‚æœå·²ç»è¿è¡Œè¿‡çš„é¡¹ç›®</p>
<p>é’ˆå¯¹ï¼šå·²ç»å¯åŠ¨çš„é¡¹ç›®ï¼Œä½¿ç”¨updateæ›´æ–°</p>
</li>
</ul>
<pre><code class="language-shell">docker update --restart=always imagesID
</code></pre>
<p><strong>restartå‚æ•°çš„å¯åŠ¨é€‰é¡¹</strong></p>
<table>
<thead>
<tr>
<th>Flag</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>no</td>
<td>ä¸è‡ªåŠ¨é‡å¯å®¹å™¨. (é»˜è®¤value)</td>
</tr>
<tr>
<td>on-failure</td>
<td>å®¹å™¨å‘ç”Ÿerrorè€Œé€€å‡º(å®¹å™¨é€€å‡ºçŠ¶æ€ä¸ä¸º0)é‡å¯å®¹å™¨</td>
</tr>
<tr>
<td>unless-stopped</td>
<td>åœ¨å®¹å™¨å·²ç»stopæ‰æˆ–Docker stoped/restartedçš„æ—¶å€™æ‰é‡å¯å®¹å™¨</td>
</tr>
<tr>
<td>always</td>
<td>åœ¨å®¹å™¨å·²ç»stopæ‰æˆ–Docker stoped/restartedçš„æ—¶å€™æ‰é‡å¯å®¹å™¨</td>
</tr>
</tbody>
</table>
<hr>
<p>è½¬è½½è‡³ï¼š<a href="https://www.cnblogs.com/gcgc/p/10494615.html#_label0">ç§‹å¯»è‰</a></p>
]]></content>
    </entry>
    <entry>
        <title type="html"><![CDATA[Dockerå®‰è£…GUIå›¾å½¢åŒ–ç•Œé¢ï¼ˆPortainerï¼‰]]></title>
        <id>https://zoengzihaam.github.io/post/15/</id>
        <link href="https://zoengzihaam.github.io/post/15/">
        </link>
        <updated>2020-07-25T13:21:42.000Z</updated>
        <content type="html"><![CDATA[<h1 id="dockerå®‰è£…guiå›¾å½¢åŒ–ç•Œé¢portainer">Dockerå®‰è£…GUIå›¾å½¢åŒ–ç•Œé¢ï¼ˆPortainerï¼‰</h1>
<blockquote>
<p>Portaineræ˜¯ä¸€ä¸ªå¼€æºã€è½»é‡çº§Dockerç®¡ç†ç”¨æˆ·ç•Œé¢ï¼ŒåŸºäºDocker APIï¼Œæä¾›çŠ¶æ€æ˜¾ç¤ºé¢æ¿ã€åº”ç”¨æ¨¡æ¿å¿«é€Ÿéƒ¨ç½²ã€å®¹å™¨é•œåƒç½‘ç»œæ•°æ®å·çš„åŸºæœ¬æ“ä½œï¼ˆåŒ…æ‹¬ä¸Šä¼ ä¸‹è½½é•œåƒï¼Œåˆ›å»ºå®¹å™¨ç­‰æ“ä½œï¼‰ã€äº‹ä»¶æ—¥å¿—æ˜¾ç¤ºã€å®¹å™¨æ§åˆ¶å°æ“ä½œã€Swarmé›†ç¾¤å’ŒæœåŠ¡ç­‰é›†ä¸­ç®¡ç†å’Œæ“ä½œã€ç™»å½•ç”¨æˆ·ç®¡ç†å’Œæ§åˆ¶ç­‰åŠŸèƒ½ã€‚åŠŸèƒ½ååˆ†å…¨é¢ï¼ŒåŸºæœ¬èƒ½æ»¡è¶³ä¸­å°å‹å•ä½å¯¹å®¹å™¨ç®¡ç†çš„å…¨éƒ¨éœ€æ±‚ã€‚</p>
</blockquote>
<h2 id="å¿«é€Ÿå…¥é—¨">å¿«é€Ÿå…¥é—¨</h2>
<h3 id="1å®˜ç½‘">1.å®˜ç½‘</h3>
<p>https://www.portainer.io/installation/</p>
<h3 id="2ä½¿ç”¨dockerå®‰è£…portainer">2.ä½¿ç”¨dockerå®‰è£…portainer</h3>
<h4 id="1æœç´¢portainer">1.æœç´¢portainer</h4>
<pre><code class="language-visual">docker search portainer
</code></pre>
<figure data-type="image" tabindex="1"><img src="https://gitee.com/zoengzihaam/ImgBed/raw/master/images/20200725205726.png" alt="image-20200725205725916" loading="lazy"></figure>
<h4 id="2å°†é•œåƒæ‹‰å–åˆ°æœ¬åœ°">2.å°†é•œåƒæ‹‰å–åˆ°æœ¬åœ°</h4>
<pre><code class="language-visual">docker pull portainer/portainer
</code></pre>
<figure data-type="image" tabindex="2"><img src="https://gitee.com/zoengzihaam/ImgBed/raw/master/images/20200725205825.png" alt="image-20200725205824991" loading="lazy"></figure>
<h4 id="3è¿è¡Œé•œåƒ">3.è¿è¡Œé•œåƒ</h4>
<pre><code class="language-vi">docker run -d -it --name portainerUI -p 9000:9000 -v /var/run/docker.sock:/var/run/docker.sock portainer/portainer
</code></pre>
<figure data-type="image" tabindex="3"><img src="https://gitee.com/zoengzihaam/ImgBed/raw/master/images/20200725205900.png" alt="image-20200725205900786" loading="lazy"></figure>
<p>æ³¨æ„ï¼šè¿™é‡Œå¦‚æœä½¿ç”¨å•æœºç‰ˆï¼Œä¸€å®šè¦ä½¿ç”¨ <code>-v /var/run/docker.sock:/var/run/docker.sock</code>ï¼Œå¦åˆ™åœ¨è¿›å…¥WEBUIçš„æ—¶å€™åˆ›å»ºä¼šå‡ºç°é—®é¢˜ï¼Œè¿™é‡Œ <code>volume</code>ä¹Ÿå¯ä½¿ç”¨å®˜æ–¹æ•™ç¨‹ï¼Œè¿™é‡Œå°†è¿è¡Œä»£ç ä¸€å¹¶è´´å…¥ã€‚</p>
<pre><code class="language-visual">docker volume create portainer_data
docker run -d -p 8000:8000 -p 9000:9000 --name=portainer --restart=always -v /var/run/docker.sock:/var/run/docker.sock -v portainer_data:/data portainer/portainer
</code></pre>
<p>å®˜æ–¹è¿™é‡Œåˆ›å»ºäº†ä¸€ä¸ªportainer_dataçš„æ–‡ä»¶å¤¹ç”¨äºå­˜å‚¨æ•°æ®ï¼Œå¤§å®¶æŒ‰éœ€è¿è¡Œå³å¯ã€‚</p>
<h3 id="3è®¿é—®portainer">3.è®¿é—®Portainer</h3>
<h4 id="1åˆ›å»ºç”¨æˆ·">1.åˆ›å»ºç”¨æˆ·</h4>
<p>æ‰“å¼€æµè§ˆå™¨è¾“å…¥ <code>ip:ç«¯å£å·</code>ï¼Œè¿™é‡Œipæ˜¯Linuxçš„åœ°å€ï¼Œç«¯å£å·ä¸ºå¯åŠ¨çš„æ—¶å€™æ˜ å°„çš„ç«¯å£ã€‚</p>
<figure data-type="image" tabindex="4"><img src="https://gitee.com/zoengzihaam/ImgBed/raw/master/images/20200725211127.png" alt="image-20200725211127863" loading="lazy"></figure>
<h4 id="2è¿æ¥dockerç¯å¢ƒ">2.è¿æ¥dockerç¯å¢ƒ</h4>
<figure data-type="image" tabindex="5"><img src="https://gitee.com/zoengzihaam/ImgBed/raw/master/images/20200725211700.png" alt="image-20200725211700177" loading="lazy"></figure>
<h4 id="3è¿›å…¥portainerç®¡ç†">3.è¿›å…¥Portainerç®¡ç†</h4>
<figure data-type="image" tabindex="6"><img src="https://gitee.com/zoengzihaam/ImgBed/raw/master/images/20200725211815.png" alt="image-20200725211815704" loading="lazy"></figure>
]]></content>
    </entry>
    <entry>
        <title type="html"><![CDATA[GateWayè‡ªå®šä¹‰å…¨å±€GlobalFilter]]></title>
        <id>https://zoengzihaam.github.io/post/13/</id>
        <link href="https://zoengzihaam.github.io/post/13/">
        </link>
        <updated>2020-07-06T11:14:01.000Z</updated>
        <content type="html"><![CDATA[<h1 id="gatewayè‡ªå®šä¹‰å…¨å±€globalfilter">GateWayè‡ªå®šä¹‰å…¨å±€GlobalFilter</h1>
<h2 id="1å®ç°ä¸¤ä¸ªæ¥å£">1.å®ç°ä¸¤ä¸ªæ¥å£</h2>
<ul>
<li>
<p>GlobalFilter</p>
<p>ç”¨äºè‡ªå®šä¹‰è¿‡æ»¤å™¨ï¼Œä¾‹å¦‚è¿›è¡ŒTokenéªŒè¯</p>
</li>
<li>
<p>Ordered</p>
<p>Springæä¾›äº†Orderedè¿™ä¸ªæ¥å£ï¼Œæ¥å¤„ç†ç›¸åŒæ¥å£å®ç°ç±»çš„ä¼˜å…ˆçº§é—®é¢˜ã€‚</p>
</li>
</ul>
<pre><code class="language-Java">import lombok.extern.slf4j.Slf4j;
import org.springframework.cloud.gateway.filter.GatewayFilterChain;
import org.springframework.cloud.gateway.filter.GlobalFilter;
import org.springframework.core.Ordered;
import org.springframework.http.HttpStatus;
import org.springframework.stereotype.Component;
import org.springframework.web.server.ServerWebExchange;
import reactor.core.publisher.Mono;

import java.util.Date;

@Component
@Slf4j
public class MyLogGateWayFilter implements GlobalFilter, Ordered {

    @Override
    public Mono&lt;Void&gt; filter(ServerWebExchange exchange, GatewayFilterChain chain) {

        //æ‰“å°è¾“å‡ºä¿¡æ¯
        log.info(&quot;************come in MyLogGateWayFilter&quot; + new Date());

        //è·å–requestä¸­çš„å‚æ•°
        String name = exchange.getRequest().getQueryParams().getFirst(&quot;name&quot;);
        //åˆ¤æ–­å‚æ•°çš„ä¿¡æ¯
        if(name ==null){
            log.info(&quot;************ç”¨æˆ·åä¸ºnullï¼Œéæ³•ç”¨æˆ·ï¼Œ/(ã„’oã„’)/~~&quot;);
            exchange.getResponse().setStatusCode(HttpStatus.NOT_ACCEPTABLE);
            return exchange.getResponse().setComplete();
        }

        return chain.filter(exchange);
    }

    @Override
    public int getOrder() {
        return 0;
    }
}
</code></pre>
<h2 id="2-ä½¿ç”¨cmdéªŒè¯">2. ä½¿ç”¨CMDéªŒè¯</h2>
<ul>
<li>
<p>éµå¾ªè¿‡æ»¤å™¨ä¸­çš„è§„åˆ™</p>
<figure data-type="image" tabindex="1"><img src="https://gitee.com/zoengzihaam/ImgBed/raw/master/images/20200706185828.png" alt="image-20200706185828629" loading="lazy"></figure>
</li>
<li>
<p>ä¸éµå¾ªè¿‡æ»¤å™¨ä¸­çš„è§„åˆ™</p>
<figure data-type="image" tabindex="2"><img src="https://gitee.com/zoengzihaam/ImgBed/raw/master/images/20200706185856.png" alt="image-20200706185856027" loading="lazy"></figure>
</li>
</ul>
<h2 id="3ç½‘é¡µç«¯æµ‹è¯•">3.ç½‘é¡µç«¯æµ‹è¯•</h2>
<ul>
<li>
<p>éµå¾ªè¿‡æ»¤å™¨ä¸­çš„è§„åˆ™</p>
<figure data-type="image" tabindex="3"><img src="https://gitee.com/zoengzihaam/ImgBed/raw/master/images/20200706185952.png" alt="image-20200706185952065" loading="lazy"></figure>
</li>
<li>
<p>ä¸éµå¾ªè¿‡æ»¤å™¨ä¸­çš„è§„åˆ™</p>
<figure data-type="image" tabindex="4"><img src="https://gitee.com/zoengzihaam/ImgBed/raw/master/images/20200706190016.png" alt="image-20200706190016823" loading="lazy"></figure>
</li>
</ul>
<p>ç»“è®ºï¼šè‡ªå®šä¹‰Filterç±»ä¼¼SpringMVCä¸­çš„Filterï¼ŒGlobalGilter å…¨å±€è¿‡æ»¤å™¨æ¥å£ä¸ GatewayFilter ç½‘å…³è¿‡æ»¤å™¨æ¥å£å…·æœ‰ç›¸åŒçš„æ–¹æ³•å®šä¹‰ã€‚å…¨å±€è¿‡æ»¤å™¨æ˜¯ä¸€ç³»åˆ—ç‰¹æ®Šçš„è¿‡æ»¤å™¨ï¼Œä¼šæ ¹æ®æ¡ä»¶åº”ç”¨åˆ°æ‰€æœ‰è·¯ç”±ä¸­ã€‚ç½‘å…³è¿‡æ»¤å™¨æ˜¯æ›´ç»†ç²’åº¦çš„è¿‡æ»¤å™¨ï¼Œä½œç”¨äºæŒ‡å®šçš„è·¯ç”±ä¸­ã€‚</p>
]]></content>
    </entry>
    <entry>
        <title type="html"><![CDATA[å¾®æœåŠ¡ä¸­ä½¿ç”¨GateWayå®ç°ä¿æŠ¤ã€å¢å¼ºå’Œæ§åˆ¶å¯¹äº API æœåŠ¡çš„è®¿é—®ã€‚]]></title>
        <id>https://zoengzihaam.github.io/post/12/</id>
        <link href="https://zoengzihaam.github.io/post/12/">
        </link>
        <updated>2020-07-06T09:16:26.000Z</updated>
        <content type="html"><![CDATA[<h1 id="å¾®æœåŠ¡ä¸­ä½¿ç”¨gatewayå®ç°ä¿æŠ¤-å¢å¼ºå’Œæ§åˆ¶å¯¹äº-api-æœåŠ¡çš„è®¿é—®">å¾®æœåŠ¡ä¸­ä½¿ç”¨GateWayå®ç°ä¿æŠ¤ã€å¢å¼ºå’Œæ§åˆ¶å¯¹äº API æœåŠ¡çš„è®¿é—®ã€‚</h1>
<blockquote>
<p>ç½‘å…³çš„è§’è‰²æ˜¯ä½œä¸ºä¸€ä¸ª API æ¶æ„ï¼Œç”¨æ¥ä¿æŠ¤ã€å¢å¼ºå’Œæ§åˆ¶å¯¹äº API æœåŠ¡çš„è®¿é—®ã€‚</p>
<p>API ç½‘å…³æ˜¯ä¸€ä¸ªå¤„äºåº”ç”¨ç¨‹åºæˆ–æœåŠ¡ï¼ˆæä¾› REST API æ¥å£æœåŠ¡ï¼‰ä¹‹å‰çš„ç³»ç»Ÿï¼Œç”¨æ¥ç®¡ç†æˆæƒã€è®¿é—®æ§åˆ¶å’Œæµé‡é™åˆ¶ç­‰ï¼Œè¿™æ · REST API æ¥å£æœåŠ¡å°±è¢« API ç½‘å…³ä¿æŠ¤èµ·æ¥ï¼Œå¯¹æ‰€æœ‰çš„è°ƒç”¨è€…é€æ˜ã€‚å› æ­¤ï¼Œéšè—åœ¨ API ç½‘å…³åé¢çš„ä¸šåŠ¡ç³»ç»Ÿå°±å¯ä»¥ä¸“æ³¨äºåˆ›å»ºå’Œç®¡ç†æœåŠ¡ï¼Œè€Œä¸ç”¨å»å¤„ç†è¿™äº›ç­–ç•¥æ€§çš„åŸºç¡€è®¾æ–½ã€‚</p>
</blockquote>
<h2 id="ç®€å•ä½¿ç”¨">ç®€å•ä½¿ç”¨</h2>
<h3 id="ä¸‰ä¸ªæ¦‚å¿µ">ä¸‰ä¸ªæ¦‚å¿µ</h3>
<figure data-type="image" tabindex="1"><img src="https://gitee.com/zoengzihaam/ImgBed/raw/master/images/20200706150913.png" alt="image-20200706150913342" loading="lazy"></figure>
<p>æ³¨ï¼šä¸Šå›¾å¼•ç”¨CSDNåšä¸»<a href="https://blog.csdn.net/rain_web/article/details/102469745">AlgoRain</a>ï¼Œè¿™é‡Œè‡´è°¢ä¸€ä¸‹å¤§ä½¬è¯¦ç»†çš„è®²è§£ã€‚</p>
<h3 id="springcloudä¸­ä½¿ç”¨">springcloudä¸­ä½¿ç”¨</h3>
<h4 id="1æ–°å»ºmodule">1.æ–°å»ºModule</h4>
<p>æ·»åŠ ä¸€ä¸ªæ–°çš„Moduleï¼Œcloud-gateway-gateway9527ï¼ˆåç§°æŒ‰ç…§è‡ªå·±å–œå¥½ï¼‰</p>
<h4 id="2æ·»åŠ pomä¾èµ–">2.æ·»åŠ POMä¾èµ–</h4>
<pre><code class="language-Java">&lt;dependencies&gt;
        &lt;!--gateway--&gt;
        &lt;dependency&gt;
            &lt;groupId&gt;org.springframework.cloud&lt;/groupId&gt;
            &lt;artifactId&gt;spring-cloud-starter-gateway&lt;/artifactId&gt;
        &lt;/dependency&gt;
        &lt;!--Eureka client--&gt;
        &lt;dependency&gt;
            &lt;groupId&gt;org.springframework.cloud&lt;/groupId&gt;
            &lt;artifactId&gt;spring-cloud-starter-netflix-eureka-client&lt;/artifactId&gt;
        &lt;/dependency&gt;
        &lt;!--å¯¼å…¥è‡ªå·±å®šä¹‰çš„apié€šç”¨åŒ…--&gt;
        &lt;dependency&gt;
            &lt;groupId&gt;com.ziznah.springcloud&lt;/groupId&gt;
            &lt;artifactId&gt;cloud-api-commons&lt;/artifactId&gt;
            &lt;version&gt;${project.version}&lt;/version&gt;
        &lt;/dependency&gt;
        &lt;!--ä¸€èˆ¬åŸºç¡€é…ç½®ç±»--&gt;
        &lt;dependency&gt;
            &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;
            &lt;artifactId&gt;spring-boot-devtools&lt;/artifactId&gt;
            &lt;scope&gt;runtime&lt;/scope&gt;
            &lt;optional&gt;true&lt;/optional&gt;
        &lt;/dependency&gt;
        &lt;dependency&gt;
            &lt;groupId&gt;org.projectlombok&lt;/groupId&gt;
            &lt;artifactId&gt;lombok&lt;/artifactId&gt;
            &lt;optional&gt;true&lt;/optional&gt;
        &lt;/dependency&gt;
        &lt;dependency&gt;
            &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;
            &lt;artifactId&gt;spring-boot-starter-test&lt;/artifactId&gt;
            &lt;scope&gt;test&lt;/scope&gt;
        &lt;/dependency&gt;
&lt;/dependencies&gt;
</code></pre>
<h4 id="3æ·»åŠ ymlæ–‡ä»¶">3.æ·»åŠ YMLæ–‡ä»¶</h4>
<pre><code class="language-yaml">#é…ç½®ç«¯å£
server:
  port: 9527

spring:
  application:
    name: cloud-gateway
  cloud:
    gateway:
      routes:
        - id: payment_routh #payment_route    #è·¯ç”±çš„IDï¼Œæ²¡æœ‰å›ºå®šè§„åˆ™ä½†è¦æ±‚å”¯ä¸€ï¼Œå»ºè®®é…åˆæœåŠ¡å
          uri: http://localhost:8001          #åŒ¹é…åæä¾›æœåŠ¡çš„è·¯ç”±åœ°å€
          predicates:
            - Path=/payment/get/**         # æ–­è¨€ï¼Œè·¯å¾„ç›¸åŒ¹é…çš„è¿›è¡Œè·¯ç”±

        - id: payment_routh2 #payment_route    #è·¯ç”±çš„IDï¼Œæ²¡æœ‰å›ºå®šè§„åˆ™ä½†è¦æ±‚å”¯ä¸€ï¼Œå»ºè®®é…åˆæœåŠ¡å
          uri: http://localhost:8001          #åŒ¹é…åæä¾›æœåŠ¡çš„è·¯ç”±åœ°å€
          predicates:
            - Path=/payment/lb/**         # æ–­è¨€ï¼Œè·¯å¾„ç›¸åŒ¹é…çš„è¿›è¡Œè·¯ç”±
#æ³¨å†Œè¿›æœåŠ¡ä¸­å¿ƒï¼Œè¿™é‡Œä½¿ç”¨çš„æ˜¯eureka
eureka:
  instance:
    hostname: cloud-gateway-service
  client: #æœåŠ¡æä¾›è€…provideræ³¨å†Œè¿›eurekaæœåŠ¡åˆ—è¡¨å†…
    service-url:
      register-with-eureka: true
      fetch-registry: true
      defaultZone: http://localhost:7001/eureka/

</code></pre>
<h4 id="4ä¸»å¯åŠ¨ç±»">4.ä¸»å¯åŠ¨ç±»</h4>
<pre><code class="language-Java">import org.springframework.boot.SpringApplication;
import org.springframework.boot.autoconfigure.SpringBootApplication;
import org.springframework.cloud.client.discovery.EnableDiscoveryClient;
import org.springframework.cloud.netflix.eureka.EnableEurekaClient;

@SpringBootApplication
@EnableEurekaClient
@EnableDiscoveryClient
public class GateWayMain9527 {
    public static void main(String[] args) {
        SpringApplication.run(GateWayMain9527.class,args);
    }
}
</code></pre>
<h4 id="ä½¿ç”¨é…ç½®ç±»æ¥ç®€å•ä½¿ç”¨gateway">ä½¿ç”¨é…ç½®ç±»æ¥ç®€å•ä½¿ç”¨GateWay</h4>
<ul>
<li>å°†http://localhost:9527/guoneiè½¬å‘åˆ°ç™¾åº¦çš„æ–°é—»ç½‘ä¸­çš„å›½å†…ä¿¡æ¯</li>
</ul>
<pre><code class="language-java">import org.springframework.cloud.gateway.route.RouteLocator;
import org.springframework.cloud.gateway.route.builder.RouteLocatorBuilder;
import org.springframework.context.annotation.Bean;
import org.springframework.context.annotation.Configuration;

@Configuration
public class GateWayConfig {

    /**
     * é…ç½®ä¸€ä¸ªidä¸ºroute-nameçš„è·¯ç”±è§„åˆ™ï¼Œ
     * å½“è®¿é—®åœ°å€http://localhost:9527/guoneiæ—¶ä¼šè‡ªåŠ¨è½¬å‘åˆ°åœ°å€ï¼šhttp://news.baidu.com/guonei
     * @param routeLocatorBuilder
     * @return
     */
    @Bean
    public RouteLocator customRouteLocator(RouteLocatorBuilder routeLocatorBuilder){
        //è·å–ç½‘å…³çš„routes
        RouteLocatorBuilder.Builder routes = routeLocatorBuilder.routes();
        //è®¾ç½®ç½‘å…³çš„å†…å®¹
        routes.route(&quot;path_route_ziznah&quot;,r -&gt; r.path(&quot;/guonei&quot;).uri(&quot;http://news.baidu.com/guonei&quot;)).build();

        //è¿”å›å†…å®¹
        return routes.build();
    }
}
</code></pre>
<h4 id="å®ç°åŠ¨æ€è·¯ç”±">å®ç°åŠ¨æ€è·¯ç”±</h4>
<ul>
<li>å¤šä¸ªæœåŠ¡æä¾›è€…è¿›è¡Œæä¾›æœåŠ¡ï¼Œä½¿ç”¨åŠ¨æ€è·¯ç”±æ¥åˆ°è¾¾è´Ÿè½½å‡è¡¡</li>
</ul>
<h5 id="1yml">1.YML</h5>
<pre><code class="language-yaml">server:
  port: 9527

spring:
  application:
    name: cloud-gateway
  cloud:
    gateway:
     #å¼€å¯åŠ¨æ€åˆ›å»ºè·¯ç”±çš„åŠŸèƒ½
      discovery:
        locator:
          enabled: true   #å¼€å¯ä»æ³¨å†Œä¸­å¿ƒåŠ¨æ€åˆ›å»ºè·¯ç”±çš„åŠŸèƒ½ï¼Œåˆ©ç”¨å¾®æœåŠ¡åè¿›è¡Œè·¯ç”±
      routes:
        - id: payment_routh #payment_route    #è·¯ç”±çš„IDï¼Œæ²¡æœ‰å›ºå®šè§„åˆ™ä½†è¦æ±‚å”¯ä¸€ï¼Œå»ºè®®é…åˆæœåŠ¡å
#          uri: http://localhost:8001          #åŒ¹é…åæä¾›æœåŠ¡çš„è·¯ç”±åœ°å€
          uri: lb://cloud-payment-service   #åŒ¹é…åæä¾›æœåŠ¡çš„è·¯ç”±åœ°å€
          predicates:
            - Path=/payment/get/**         # æ–­è¨€ï¼Œè·¯å¾„ç›¸åŒ¹é…çš„è¿›è¡Œè·¯ç”±

        - id: payment_routh2 #payment_route    #è·¯ç”±çš„IDï¼Œæ²¡æœ‰å›ºå®šè§„åˆ™ä½†è¦æ±‚å”¯ä¸€ï¼Œå»ºè®®é…åˆæœåŠ¡å
#          uri: http://localhost:8001          #åŒ¹é…åæä¾›æœåŠ¡çš„è·¯ç”±åœ°å€
          uri: lb://cloud-payment-service   #åŒ¹é…åæä¾›æœåŠ¡çš„è·¯ç”±åœ°å€
          predicates:
            - Path=/payment/lb/**         # æ–­è¨€ï¼Œè·¯å¾„ç›¸åŒ¹é…çš„è¿›è¡Œè·¯ç”±

eureka:
  instance:
    hostname: cloud-gateway-service
  client: #æœåŠ¡æä¾›è€…provideræ³¨å†Œè¿›eurekaæœåŠ¡åˆ—è¡¨å†…
    service-url:
      register-with-eureka: true
      fetch-registry: true
      defaultZone: http://localhost:7001/eureka/
</code></pre>
<p>æ³¨ï¼šéœ€è¦æ³¨æ„çš„æ˜¯uriçš„åè®®lbï¼Œè¡¨ç¤ºå¯ç”¨Gatewayçš„è´Ÿè½½å‡è¡¡åŠŸèƒ½ï¼Œlb://serverNameæ˜¯spring cloud  gatwayåœ¨å¾®æœåŠ¡ä¸­è‡ªåŠ¨ä¸ºæˆ‘ä»¬åˆ›å»ºçš„è´Ÿè½½å‡è¡¡uriã€‚</p>
<h3 id="predicatesæ–­è¨€ä¸åŒç±»å‹">predicatesæ–­è¨€ä¸åŒç±»å‹</h3>
<h4 id="1after">1.After</h4>
<ul>
<li>YMLæ–‡ä»¶</li>
</ul>
<pre><code class="language-yaml"># æ–­è¨€ï¼Œè·¯å¾„ç›¸åŒ¹é…çš„è¿›è¡Œè·¯ç”±
predicates:		
	- After=2020-07-06T16:43:08.146+08:00[Asia/Shanghai]
</code></pre>
<p>ä¸Šè¿°çš„æ—¶é—´åœ°å€å¯ä½¿ç”¨Javaä¸­timeçš„apiæ¥è·å–ï¼š</p>
<pre><code class="language-java">import java.time.ZoneId;
import java.time.ZonedDateTime;

public class T2 {
    public static void main(String[] args) {
        //è·å–é»˜è®¤æ—¶åŒº
        ZonedDateTime zdt = ZonedDateTime.now();
        System.out.println(zdt);
        //é€šè¿‡æŒ‡å®šæ—¶åŒºè·å–å½“å‰æ—¶é—´
        ZonedDateTime now = ZonedDateTime.now(ZoneId.of(&quot;America/New_York&quot;));
        System.out.println(now);
    }
}
</code></pre>
<figure data-type="image" tabindex="2"><img src="https://gitee.com/zoengzihaam/ImgBed/raw/master/images/20200706164619.png" alt="image-20200706164619481" loading="lazy"></figure>
<h4 id="2before">2.Before</h4>
<p>æ–¹æ³•åŒAfter</p>
<h4 id="3between">3.Between</h4>
<p>æ–¹æ³•åŒAfter</p>
<h4 id="4cookie">4.Cookie</h4>
<ul>
<li>YMLæ–‡ä»¶</li>
</ul>
<pre><code class="language-yaml"># æ–­è¨€ï¼Œè·¯å¾„ç›¸åŒ¹é…çš„è¿›è¡Œè·¯ç”±
predicates:		
	- Cookie=ceshi,admin	
</code></pre>
<p>Windowsä¸­CMDçª—å£ä½¿ç”¨curlå‘½ä»¤è¿›è¡Œhttpè¯·æ±‚</p>
<ul>
<li>ä¸å¸¦Cookieè¿›è¡Œè®¿é—®æµ‹è¯•ã€‚</li>
</ul>
<figure data-type="image" tabindex="3"><img src="https://gitee.com/zoengzihaam/ImgBed/raw/master/images/20200706165615.png" alt="image-20200706165615728" loading="lazy"></figure>
<ul>
<li>å¸¦Cookieè¿›è¡Œè®¿é—®æµ‹è¯•ã€‚</li>
</ul>
<figure data-type="image" tabindex="4"><img src="https://gitee.com/zoengzihaam/ImgBed/raw/master/images/20200706165741.png" alt="image-20200706165741593" loading="lazy"></figure>
<h4 id="5header">5.Header</h4>
<ul>
<li>YMLæ–‡ä»¶</li>
</ul>
<pre><code class="language-yaml"># æ–­è¨€ï¼Œè·¯å¾„ç›¸åŒ¹é…çš„è¿›è¡Œè·¯ç”±
predicates:		
	- Header=X-Request-Id, \d+		#è¯·æ±‚å¤´è¦æœ‰X-Request-Idå±æ€§ï¼Œå¹¶ä¸”å€¼ä¸ºæ­£æ•°çš„æ­£åˆ™è¡¨è¾¾å¼ã€‚
</code></pre>
<p>ä½¿ç”¨CMDçš„curlå‘½ä»¤æµ‹è¯•</p>
<ul>
<li>å¸¦Header</li>
</ul>
<figure data-type="image" tabindex="5"><img src="https://gitee.com/zoengzihaam/ImgBed/raw/master/images/20200706170541.png" alt="image-20200706170541704" loading="lazy"></figure>
<ul>
<li>
<p>ä¸å¸¦Header</p>
<figure data-type="image" tabindex="6"><img src="https://gitee.com/zoengzihaam/ImgBed/raw/master/images/20200706170608.png" alt="image-20200706170608051" loading="lazy"></figure>
</li>
<li>
<p>å¸¦é”™è¯¯çš„Headerä¿¡æ¯</p>
<figure data-type="image" tabindex="7"><img src="https://gitee.com/zoengzihaam/ImgBed/raw/master/images/20200706170644.png" alt="image-20200706170644528" loading="lazy"></figure>
</li>
</ul>
<h4 id="6host">6.Host</h4>
<ul>
<li>YML</li>
</ul>
<pre><code class="language-yaml"># æ–­è¨€ï¼Œè·¯å¾„ç›¸åŒ¹é…çš„è¿›è¡Œè·¯ç”±
predicates:		
	- Host=**.ceshi.com
</code></pre>
<p>ä½¿ç”¨CMDçš„curlå‘½ä»¤æµ‹è¯•</p>
<ul>
<li>
<p>å¸¦Hostæµ‹è¯•</p>
<figure data-type="image" tabindex="8"><img src="https://gitee.com/zoengzihaam/ImgBed/raw/master/images/20200706171138.png" alt="image-20200706171138672" loading="lazy"></figure>
</li>
<li>
<p>ä¸å¸¦Hostæµ‹è¯•</p>
<figure data-type="image" tabindex="9"><img src="https://gitee.com/zoengzihaam/ImgBed/raw/master/images/20200706171300.png" alt="image-20200706171300046" loading="lazy"></figure>
</li>
<li>
<p>å¸¦é”™è¯¯Hostæµ‹è¯•</p>
<figure data-type="image" tabindex="10"><img src="https://gitee.com/zoengzihaam/ImgBed/raw/master/images/20200706171234.png" alt="image-20200706171234897" loading="lazy"></figure>
</li>
</ul>
<h4 id="7method">7.Method</h4>
<ul>
<li>YML</li>
</ul>
<pre><code class="language-yaml"># æ–­è¨€ï¼Œè·¯å¾„ç›¸åŒ¹é…çš„è¿›è¡Œè·¯ç”±
predicates:		
	- Method=GET
</code></pre>
<h4 id="8path">8.Path</h4>
<h4 id="9query">9.Query</h4>
<h4 id="10weight">10.Weight</h4>
]]></content>
    </entry>
    <entry>
        <title type="html"><![CDATA[å‚è€ƒRoundRobinRuleä»£ç æ¨¡æ‹Ÿè´Ÿè½½å‡è¡¡]]></title>
        <id>https://zoengzihaam.github.io/post/11/</id>
        <link href="https://zoengzihaam.github.io/post/11/">
        </link>
        <updated>2020-06-25T10:12:34.000Z</updated>
        <content type="html"><![CDATA[<h1 id="å‚è€ƒroundrobinruleä»£ç æ¨¡æ‹Ÿè´Ÿè½½å‡è¡¡">å‚è€ƒRoundRobinRuleä»£ç æ¨¡æ‹Ÿè´Ÿè½½å‡è¡¡</h1>
<h2 id="1å®šä¹‰ä¸€ä¸ªloadbalanceræ¥å£">1.å®šä¹‰ä¸€ä¸ªLoadBalanceræ¥å£</h2>
<ul>
<li>è·å–æœåŠ¡å™¨é›†ç¾¤ä¸Šèƒ½å¤Ÿæä¾›æœåŠ¡çš„æœºå™¨æ•°é‡</li>
</ul>
<pre><code class="language-java">public interface Loadbalancer {
    /**
     * è·å–æœåŠ¡å™¨é›†ç¾¤ä¸Šèƒ½å¤Ÿæä¾›æœåŠ¡çš„æœºå™¨æ•°é‡
     * @param serviceInstances
     * @return
     */
    ServiceInstance instances(List&lt;ServiceInstance&gt; serviceInstances);
}
</code></pre>
<h2 id="2å®ç°loadbalanceræ¥å£ä¸­çš„æ–¹æ³•">2.å®ç°LoadBalanceræ¥å£ä¸­çš„æ–¹æ³•</h2>
<ul>
<li>åˆ©ç”¨è‡ªæ—‹é”ï¼Œåˆ›å»ºè·å–å½“å‰æœåŠ¡è°ƒç”¨æ˜¯ç¬¬å‡ æ¬¡è®¿é—®çš„æ–¹æ³•</li>
<li>å®ç°æ¥å£ä¸­è·å–æä¾›æœåŠ¡æœºå™¨æ•°é‡çš„æ–¹æ³•ï¼Œæ¨¡æ‹Ÿè´Ÿè½½å‡è¡¡ç®—æ³•æ¥è¾¾åˆ°è´Ÿè½½è°ƒç”¨æœåŠ¡ã€‚</li>
</ul>
<pre><code class="language-java">/**
 * ClassName: MyLB
 * Description: å‚è€ƒRoundRobinRuleä»£ç æ¨¡æ‹Ÿè´Ÿè½½å‡è¡¡
 * Author: SUGAR
 * Date: 2020/6/25 16:09
 * Version: 1.0
 **/
@Component
public class MyLB implements Loadbalancer{

    private AtomicInteger atomicInteger = new AtomicInteger(0);

    /**
     * è·å–å½“å‰æœåŠ¡è°ƒç”¨æ˜¯ç¬¬å‡ æ¬¡è®¿é—®
     * @return
     */
    public final int getAndIncrement(){
        int current;
        int next;

        do {
            current = this.atomicInteger.get();
            next = current &gt;= 2147483647 ? 0 : current + 1;
        }while (!this.atomicInteger.compareAndSet(current,next));
        System.out.println(&quot;*****è®¿é—®ç¬¬&quot; + next + &quot;æ¬¡ï¼*****&quot;);
        return next;
    }

    /**
     * æ ¹æ®ç¬¬å‡ æ¬¡è®¿é—®ï¼Œæ¨¡æ‹Ÿè´Ÿè½½å‡è¡¡ç®—æ³•æ¥è¾¾åˆ°è´Ÿè½½è°ƒç”¨æœåŠ¡
     * è´Ÿè½½å‡è¡¡ç®—æ³•ï¼šrestæ¥å£ç¬¬å‡ æ¬¡è¯·æ±‚æ•° % æœåŠ¡å™¨é›†ç¾¤æ€»æ•°é‡ = å®é™…è°ƒç”¨æœåŠ¡å™¨ä½ç½®ä¸‹æ ‡
     * æ¯æ¬¡æœåŠ¡å¯åŠ¨årestæ¥å£è®¡æ•°ä»1å¼€å§‹
     * @param serviceInstances
     * @return
     */
    @Override
    public ServiceInstance instances(List&lt;ServiceInstance&gt; serviceInstances) {

        int index = getAndIncrement() % serviceInstances.size();

        return serviceInstances.get(index);
    }
}
</code></pre>
<h2 id="3å–æ¶ˆloadbalancedæ³¨è§£">3.å–æ¶ˆLoadBalancedæ³¨è§£</h2>
<ul>
<li>å–æ¶ˆApplicationContextConfigä¸­RestTemplateçš„getæ–¹æ³•çš„LoadBalancedæ³¨è§£ï¼Œä½¿ç”¨è‡ªå·±æ¨¡æ‹Ÿçš„è´Ÿè½½å‡è¡¡ã€‚</li>
</ul>
<pre><code class="language-java">@Configuration
public class ApplicationContextConfig {

    @Bean
//    @LoadBalanced ä½¿ç”¨è‡ªå·±æ¨¡æ‹Ÿçš„è´Ÿè½½å‡è¡¡çš„æ–¹æ³•
    public RestTemplate getRestTemplate(){
        return new RestTemplate();
    }
}
</code></pre>
<h2 id="4æ·»åŠ æœåŠ¡æä¾›å•†æä¾›çš„controlleræ–¹æ³•">4.æ·»åŠ æœåŠ¡æä¾›å•†æä¾›çš„controlleræ–¹æ³•</h2>
<ul>
<li>æ·»åŠ ä¸€ä¸ªè·å–å½“å‰æœåŠ¡æä¾›è€…ç«¯å£çš„æ–¹æ³•ï¼Œç”¨æ¥è´Ÿè½½å‡è¡¡ã€‚</li>
</ul>
<pre><code class="language-java">@GetMapping(value = &quot;/payment/lb&quot;)
public String getPaymentLB() {
    return serverPort;
}
</code></pre>
<p><font style="color:red"><strong>æ³¨ï¼š</strong></font>è¿™é‡Œçš„æ–¹æ³•æ·»åŠ åˆ°æä¾›å•†çš„controllerä¸­ã€‚</p>
<h2 id="5è°ƒç”¨è€…æ·»åŠ controlleræ–¹æ³•">5.è°ƒç”¨è€…æ·»åŠ controlleræ–¹æ³•</h2>
<ul>
<li>è°ƒç”¨è€…controlleræ·»åŠ è°ƒç”¨æœåŠ¡æä¾›å•†çš„æ–¹æ³•ï¼Œæµ‹è¯•è´Ÿè½½å‡è¡¡</li>
</ul>
<pre><code class="language-java">@GetMapping(value = &quot;/consumer/payment/lb&quot;)
public String getPayementLB(){
    List&lt;ServiceInstance&gt; instances = discoveryClient.getInstances(&quot;CLOUD-PAYMENT-SERVICE&quot;);
    //åˆ¤æ–­æœåŠ¡æ˜¯å¦ä¸ºæœ‰æ•ˆæœåŠ¡
    if(instances == null || instances.size() &lt;= 0){
        return null;
    }

    ServiceInstance serviceInstance = loadbalancer.instances(instances);
    URI uri = serviceInstance.getUri();

    return restTemplate.getForObject(uri + &quot;/payment/lb&quot;,String.class);
}
</code></pre>
<h2 id="6æµ‹è¯•">6.æµ‹è¯•</h2>
<ul>
<li>å¯åŠ¨å¯¹åº”çš„æœåŠ¡</li>
</ul>
<figure data-type="image" tabindex="1"><img src="https://gitee.com/zoengzihaam/ImgBed/raw/master/images/20200625175834.png" alt="image-20200625175834663" loading="lazy"></figure>
<ul>
<li>æŸ¥çœ‹æ˜¯å¦å¯åŠ¨æˆåŠŸï¼ˆæ¨¡æ‹Ÿæä¾›è€…é›†ç¾¤ä»¥åŠæœåŠ¡å™¨é›†ç¾¤ï¼‰</li>
</ul>
<figure data-type="image" tabindex="2"><img src="https://gitee.com/zoengzihaam/ImgBed/raw/master/images/20200625180016.png" alt="image-20200625180016280" loading="lazy"></figure>
<ul>
<li>æ¨¡æ‹Ÿè°ƒç”¨è€…è®¿é—®æ¥å£</li>
</ul>
<figure data-type="image" tabindex="3"><img src="https://gitee.com/zoengzihaam/ImgBed/raw/master/images/20200625180207.png" alt="image-20200625180207309" loading="lazy"></figure>
<figure data-type="image" tabindex="4"><img src="https://gitee.com/zoengzihaam/ImgBed/raw/master/images/20200625180221.png" alt="image-20200625180221054" loading="lazy"></figure>
<figure data-type="image" tabindex="5"><img src="https://gitee.com/zoengzihaam/ImgBed/raw/master/images/20200625180244.png" alt="image-20200625180244048" loading="lazy"></figure>
<p>â€‹	æ ¹æ®ä»¥ä¸Šè°ƒç”¨ï¼Œåå°ä¹Ÿæ‰“å°å‡ºç›¸åº”çš„è°ƒç”¨ä¿¡æ¯ã€‚</p>
]]></content>
    </entry>
    <entry>
        <title type="html"><![CDATA[Dockerä¸­ CMD ä¸ ENTRYPOINT ä¿ç•™æŒ‡ä»¤çš„åŒºåˆ«]]></title>
        <id>https://zoengzihaam.github.io/post/10/</id>
        <link href="https://zoengzihaam.github.io/post/10/">
        </link>
        <updated>2020-06-09T13:52:56.000Z</updated>
        <content type="html"><![CDATA[<blockquote>
<p>ç¼–å†™Dockerfileæ—¶ï¼Œæ—¶å¸¸çœ‹åˆ°æœ€åä¼šçœ‹åˆ°CMDæˆ–è€…ENTRYPOINT çš„ä¿ç•™æŒ‡ä»¤ï¼Œä½†æ˜¯ä»–ä»¬çš„æ„ä¹‰éƒ½ä¸ºï¼šæŒ‡å®šä¸€ä¸ªå®¹å™¨å¯åŠ¨æ—¶è¦è¿è¡Œçš„å‘½ä»¤ï¼Œé‚£ä¹ˆå®ƒä»¬ä¹‹é—´çš„å·®å¼‚åœ¨å“ªé‡Œï¼Ÿ</p>
</blockquote>
<h2 id="ä½¿ç”¨curlå‘½ä»¤æ¥è¯´æ˜">ä½¿ç”¨curlå‘½ä»¤æ¥è¯´æ˜</h2>
<h3 id="é¦–å…ˆç¼–å†™ä¸¤ä¸ªdockerfile">é¦–å…ˆç¼–å†™ä¸¤ä¸ªDockerfile</h3>
<ol>
<li>ä½¿ç”¨<code>CMD</code>ä¿ç•™æŒ‡ä»¤ã€‚</li>
</ol>
<pre><code class="language-shell">FROM centos
RUN yum install -y curl
CMD [ &quot;curl&quot;, &quot;-s&quot;, &quot;https://www.baidu.com/&quot; ]
</code></pre>
<p>è¿™é‡Œ Dockerfile çš„åå­—è¦æ±‚å°å†™ï¼Œå¦åˆ™ä¼šæŠ¥é”™<code>invalid argument &quot;cmdCentos&quot; for &quot;-t, --tag&quot; flag: invalid reference format: repository name must be lowercase See 'docker build --help'.</code></p>
<figure data-type="image" tabindex="1"><img src="https://gitee.com/zoengzihaam/ImgBed/raw/master/images/20200609213217.png" alt="image-20200609213217668" loading="lazy"></figure>
<ol start="2">
<li>ä½¿ç”¨<code>ENTRYPOINT</code>ä¿ç•™æŒ‡ä»¤ã€‚</li>
</ol>
<pre><code class="language-shell">FROM centos
RUN yum install -y curl
ENTRYPOINT [ &quot;curl&quot;, &quot;-s&quot;, &quot;https://www.baidu.com/&quot; ]
</code></pre>
<figure data-type="image" tabindex="2"><img src="https://gitee.com/zoengzihaam/ImgBed/raw/master/images/20200609213320.png" alt="image-20200609213320960" loading="lazy"></figure>
<h3 id="åœ¨dockerä¸­è¿›è¡Œbuildè¿›è¡Œæ„å»ºä¸€ä¸ªæ–°çš„é•œåƒ">åœ¨dockerä¸­è¿›è¡Œbuildè¿›è¡Œæ„å»ºä¸€ä¸ªæ–°çš„é•œåƒ</h3>
<ol>
<li>
<p>æ„å»º<code>CMD</code>ä¿ç•™æŒ‡ä»¤çš„Dockerfileã€‚</p>
<figure data-type="image" tabindex="3"><img src="https://gitee.com/zoengzihaam/ImgBed/raw/master/images/20200609213449.png" alt="image-20200609213449579" loading="lazy"></figure>
</li>
<li>
<p>æ„å»º<code>ENTRYPOINT</code>ä¿ç•™æŒ‡ä»¤çš„Dockerfileã€‚</p>
<figure data-type="image" tabindex="4"><img src="https://gitee.com/zoengzihaam/ImgBed/raw/master/images/20200609213554.png" alt="image-20200609213553986" loading="lazy"></figure>
</li>
</ol>
<h3 id="è¿è¡Œä¸¤ä¸ªé•œåƒè¿›è¡Œå¯¹æ¯”">è¿è¡Œä¸¤ä¸ªé•œåƒè¿›è¡Œå¯¹æ¯”</h3>
<ol>
<li>
<p>è¿è¡Œ<code>CMD</code>ä¿ç•™æŒ‡ä»¤çš„é•œåƒã€‚</p>
<figure data-type="image" tabindex="5"><img src="https://gitee.com/zoengzihaam/ImgBed/raw/master/images/20200609213732.png" alt="image-20200609213732383" loading="lazy"></figure>
</li>
<li>
<p>è¿è¡Œ<code>ENTRYPOINT</code>ä¿ç•™æŒ‡ä»¤çš„é•œåƒã€‚</p>
<figure data-type="image" tabindex="6"><img src="https://gitee.com/zoengzihaam/ImgBed/raw/master/images/20200609213855.png" alt="image-20200609213855288" loading="lazy"></figure>
</li>
</ol>
<p>è¿™ä¸ªæ—¶å€™æˆ‘ä»¬å‘ç°ï¼Œä¸¤ä¸ªé•œåƒè¿è¡Œèµ·æ¥æ²¡æœ‰ä»»ä½•åŒºåˆ«ï¼Œä½†æ˜¯<strong>é‡ç‚¹æ¥äº†</strong>ï¼å½“æˆ‘ä»¬éœ€è¦<strong>å¯¹é•œåƒå¯åŠ¨æ—¶è¦è¿è¡Œçš„å‘½ä»¤è¿›è¡Œå¢å¼º</strong>çš„æ—¶å€™ã€‚</p>
<p>æ¯”å¦‚æˆ‘ä»¬è¿˜æƒ³è·å–æŒ‡å®šç½‘ç«™çš„<code>å¤´ä¿¡æ¯</code>ã€‚</p>
<ol start="3">
<li>
<p>è¿è¡Œå¢å¼ºåçš„<code>CMD</code>ä¿ç•™æŒ‡ä»¤çš„é•œåƒã€‚</p>
<figure data-type="image" tabindex="7"><img src="https://gitee.com/zoengzihaam/ImgBed/raw/master/images/20200609214241.png" alt="image-20200609214241092" loading="lazy"></figure>
</li>
<li>
<p>è¿è¡Œå¢å¼ºåçš„<code>ENTRYPOINT</code>ä¿ç•™æŒ‡ä»¤çš„é•œåƒã€‚</p>
<figure data-type="image" tabindex="8"><img src="https://gitee.com/zoengzihaam/ImgBed/raw/master/images/20200609214443.png" alt="image-20200609214443164" loading="lazy"></figure>
</li>
</ol>
<h3 id="æ€»ç»“">æ€»ç»“</h3>
<p>ç”±ä¸Šè¿°çš„æ¡ˆä¾‹ï¼Œæˆ‘ä»¬ä¸éš¾å‘ç°ï¼Œåœ¨æ‰§è¡ŒDockerfileä¸­ï¼Œå¦‚æœä½¿ç”¨äº†<code>CMD</code>ä¿ç•™æŒ‡ä»¤ï¼Œé‚£ä¹ˆåœ¨æ‰§è¡Œé•œåƒçš„æ—¶å€™ï¼Œæˆ‘ä»¬åœ¨å…¶å¯åŠ¨å‘½ä»¤åé¢æ·»åŠ <code>OPTION</code>é€‰é¡¹çš„æ—¶å€™ï¼Œå°†ä¼šè¦†ç›–Dockerfileä¸­çš„ä¸Šä¸€å¥æŒ‡ä»¤ï¼Œé€ æˆè¿è¡Œå¤±è´¥ã€‚ä¾‹å¦‚ï¼š</p>
<pre><code class="language-shell">FROM centos
RUN yum install -y curl
CMD [ &quot;curl&quot;, &quot;-s&quot;, &quot;https://www.baidu.com/&quot; ]
CMD -i
</code></pre>
<p>å¦‚æœä½¿ç”¨<code>ENTRYPOINT</code>ä¿ç•™æŒ‡ä»¤ï¼Œé‚£ä¹ˆåœ¨æ‰§è¡Œé•œåƒçš„æ—¶å€™ï¼Œæˆ‘ä»¬åœ¨å…¶å¯åŠ¨å‘½ä»¤åé¢æ·»åŠ <code>OPTION</code>é€‰é¡¹çš„æ—¶å€™ï¼Œä¼šå¯¹è¿è¡Œçš„å‘½ä»¤è¿›è¡Œ<code>â€œå¢å¼ºâ€</code>ã€‚ä¾‹å¦‚ï¼š</p>
<pre><code class="language-shell">FROM centos
RUN yum install -y curl
ENTRYPOINT [ &quot;curl&quot;, &quot;-s&quot;,&quot;-i&quot;, &quot;https://www.baidu.com/&quot; ]
</code></pre>
<p>æ‰€ä»¥ï¼Œåœ¨å®é™…åº”ç”¨ä¸­ï¼Œæ˜¯ä½¿ç”¨<code>CMD</code>è¿˜æ˜¯<code>ENTRYPOINT</code>ä¿ç•™æŒ‡ä»¤ï¼Œè¦æ ¹æ®å…·ä½“çš„ä¸šåŠ¡è¦æ±‚ã€‚</p>
]]></content>
    </entry>
</feed>